
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A comprehensive guide to building an Internal Developer Platform using Crossplane and GitOps principles">
      
      
        <meta name="author" content="Sebastiian Ickler">
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../02-networking-composition/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>Module 1: Your First Composition - Internal Developer Platform Tutorial</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-1-your-first-composition" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Internal Developer Platform Tutorial" class="md-header__button md-logo" aria-label="Internal Developer Platform Tutorial" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Internal Developer Platform Tutorial
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Module 1: Your First Composition
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Internal Developer Platform Tutorial" class="md-nav__button md-logo" aria-label="Internal Developer Platform Tutorial" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Internal Developer Platform Tutorial
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/01-introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01: Introduction to the GitOps Workflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/02-devbox-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02: Devbox Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/03-local-cluster-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03: Local Cluster Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/04-gitops-bootstrap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04: GitOps Bootstrap with ArgoCD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/05-sealed-secrets-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    05: Secure Secret Management (Sealed Secrets)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    GitOps Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            GitOps Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gitops-fundamentals/01-argocd-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01: ArgoCD Setup for Crossplane
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gitops-fundamentals/02-crossplane-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02: Crossplane Integration with ArgoCD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gitops-fundamentals/03-workflow-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03: GitOps Workflow Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Crossplane Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Crossplane Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crossplane-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Crossplane Fundamentals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crossplane-fundamentals/01-azure-provider-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Module 1: Azure Provider Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crossplane-fundamentals/02-first-managed-resource/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Module 2: Your First Managed Resource
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crossplane-fundamentals/03-understanding-crossplane/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Module 3: Understanding What Happened
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/01-chainguard-images/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01: Securing the Supply Chain with Chainguard Images
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/02-secret-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02: Secret Management in a GitOps World
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/03-rbac/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03: RBAC and Least Privilege
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Crossplane Advanced Patterns
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Crossplane Advanced Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Crossplane Advanced Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Module 1: Your First Composition
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Module 1: Your First Composition
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tutorial-approach-single-repository-learning" class="md-nav__link">
    <span class="md-ellipsis">
      Tutorial Approach: Single Repository Learning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-problem-were-solving" class="md-nav__link">
    <span class="md-ellipsis">
      The Problem We're Solving
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-apply-rock-solid-gitops-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Apply Rock-Solid GitOps Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 1: Apply Rock-Solid GitOps Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-create-gitops-ready-directory-structure" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 Create GitOps-Ready Directory Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-platform-component-workflow-integration" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 Platform Component Workflow Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-crossplane-in-the-gitops-promotion-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 Crossplane in the GitOps Promotion Pipeline
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-design-the-developer-api" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Design the Developer API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Design the Developer API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#13-understanding-namespaced-composite-resources-in-v2" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 Understanding Namespaced Composite Resources in v2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-build-the-function-based-composition" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Build the Function-Based Composition
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Build the Function-Based Composition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#patch-types-deep-dive" class="md-nav__link">
    <span class="md-ellipsis">
      Patch Types Deep Dive
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Patch Types Deep Dive">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fromcompositefieldpath" class="md-nav__link">
    <span class="md-ellipsis">
      FromCompositeFieldPath
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tocompositefieldpath" class="md-nav__link">
    <span class="md-ellipsis">
      ToCompositeFieldPath
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transforms" class="md-nav__link">
    <span class="md-ellipsis">
      Transforms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-create-argocd-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Create ArgoCD Applications
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-deploy-the-platform" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Deploy the Platform
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Deploy the Platform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-update-repository-urls" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Update Repository URLs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-commit-platform-components" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Commit Platform Components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-deploy-argocd-applications" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Deploy ArgoCD Applications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-verify-platform-installation" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 Verify Platform Installation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-apply-gitops-workflow-to-crossplane" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Apply GitOps Workflow to Crossplane! 🎉
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 5: Apply GitOps Workflow to Crossplane! 🎉">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-github-flow-create-development-environment" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 GitHub Flow: Create Development Environment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.1 GitHub Flow: Create Development Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#development-team-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Development Team Workflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-pr-environment-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic PR Environment Testing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-environment-promotion-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 Environment Promotion Pipeline
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.2 Environment Promotion Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stage-1-development-automatic" class="md-nav__link">
    <span class="md-ellipsis">
      Stage 1: Development (Automatic)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stage-2-staging-promotion-manual" class="md-nav__link">
    <span class="md-ellipsis">
      Stage 2: Staging Promotion (Manual)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stage-3-production-promotion-strict-control" class="md-nav__link">
    <span class="md-ellipsis">
      Stage 3: Production Promotion (Strict Control)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-argocd-applications-for-environment-based-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 ArgoCD Applications for Environment-Based Workflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-deploy-gitops-infrastructure" class="md-nav__link">
    <span class="md-ellipsis">
      5.4 Deploy GitOps Infrastructure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55-gitops-monitoring-troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      5.5 GitOps Monitoring &amp; Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.5 GitOps Monitoring &amp; Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#monitor-gitops-crossplane-health" class="md-nav__link">
    <span class="md-ellipsis">
      Monitor GitOps + Crossplane Health
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-common-gitops-crossplane-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting Common GitOps + Crossplane Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-gitops-crossplane-integration-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: GitOps + Crossplane Integration Benefits
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 6: GitOps + Crossplane Integration Benefits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-end-to-end-workflow-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 End-to-End Workflow Visualization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-rock-solid-workflow-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 Rock-Solid Workflow Benefits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-check-environment-status" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 Check Environment Status
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-add-another-developer" class="md-nav__link">
    <span class="md-ellipsis">
      Step 7: Add Another Developer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#learning-outcomes" class="md-nav__link">
    <span class="md-ellipsis">
      Learning Outcomes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-concepts-introduced" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Concepts Introduced
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Concepts Introduced">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-design-principles" class="md-nav__link">
    <span class="md-ellipsis">
      API Design Principles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composition-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      Composition Techniques
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting-common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting Common Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting Common Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xrd-not-available" class="md-nav__link">
    <span class="md-ellipsis">
      XRD Not Available
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composition-not-working" class="md-nav__link">
    <span class="md-ellipsis">
      Composition Not Working
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resources-not-creating" class="md-nav__link">
    <span class="md-ellipsis">
      Resources Not Creating
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#platform-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Platform Documentation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Platform Documentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#developer-guide" class="md-nav__link">
    <span class="md-ellipsis">
      Developer Guide
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-you-get" class="md-nav__link">
    <span class="md-ellipsis">
      What You Get
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What You Get">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-structure-created" class="md-nav__link">
    <span class="md-ellipsis">
      File Structure Created
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-networking-composition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Module 2: Networking Composition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-environment-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Module 3: Environment Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Observability
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Observability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/01-health-checks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01: Health Checks and Resource Status
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/02-monitoring-with-prometheus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02: Monitoring with Prometheus
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/03-alerting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03: Alerting on Infrastructure State
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Repository Management
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Repository Management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../repository-management/01-multi-repo-strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01: Multi-Repo Strategy for GitOps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../repository-management/02-repository-templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02: Repository Templates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../repository-management/03-cross-repo-coordination/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03: Cross-Repo Coordination with ArgoCD
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced Topics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Advanced Topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/01-composition-functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01: Extending Crossplane with Composition Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/02-multi-cluster-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02: Multi-Cluster Management
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tutorial-approach-single-repository-learning" class="md-nav__link">
    <span class="md-ellipsis">
      Tutorial Approach: Single Repository Learning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-problem-were-solving" class="md-nav__link">
    <span class="md-ellipsis">
      The Problem We're Solving
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-apply-rock-solid-gitops-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Apply Rock-Solid GitOps Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 1: Apply Rock-Solid GitOps Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-create-gitops-ready-directory-structure" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 Create GitOps-Ready Directory Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-platform-component-workflow-integration" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 Platform Component Workflow Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-crossplane-in-the-gitops-promotion-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 Crossplane in the GitOps Promotion Pipeline
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-design-the-developer-api" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Design the Developer API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Design the Developer API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#13-understanding-namespaced-composite-resources-in-v2" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 Understanding Namespaced Composite Resources in v2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-build-the-function-based-composition" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Build the Function-Based Composition
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Build the Function-Based Composition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#patch-types-deep-dive" class="md-nav__link">
    <span class="md-ellipsis">
      Patch Types Deep Dive
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Patch Types Deep Dive">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fromcompositefieldpath" class="md-nav__link">
    <span class="md-ellipsis">
      FromCompositeFieldPath
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tocompositefieldpath" class="md-nav__link">
    <span class="md-ellipsis">
      ToCompositeFieldPath
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transforms" class="md-nav__link">
    <span class="md-ellipsis">
      Transforms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-create-argocd-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Create ArgoCD Applications
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-deploy-the-platform" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Deploy the Platform
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Deploy the Platform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-update-repository-urls" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Update Repository URLs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-commit-platform-components" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Commit Platform Components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-deploy-argocd-applications" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Deploy ArgoCD Applications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-verify-platform-installation" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 Verify Platform Installation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-apply-gitops-workflow-to-crossplane" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Apply GitOps Workflow to Crossplane! 🎉
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 5: Apply GitOps Workflow to Crossplane! 🎉">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-github-flow-create-development-environment" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 GitHub Flow: Create Development Environment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.1 GitHub Flow: Create Development Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#development-team-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Development Team Workflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-pr-environment-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic PR Environment Testing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-environment-promotion-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 Environment Promotion Pipeline
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.2 Environment Promotion Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stage-1-development-automatic" class="md-nav__link">
    <span class="md-ellipsis">
      Stage 1: Development (Automatic)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stage-2-staging-promotion-manual" class="md-nav__link">
    <span class="md-ellipsis">
      Stage 2: Staging Promotion (Manual)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stage-3-production-promotion-strict-control" class="md-nav__link">
    <span class="md-ellipsis">
      Stage 3: Production Promotion (Strict Control)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-argocd-applications-for-environment-based-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 ArgoCD Applications for Environment-Based Workflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-deploy-gitops-infrastructure" class="md-nav__link">
    <span class="md-ellipsis">
      5.4 Deploy GitOps Infrastructure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55-gitops-monitoring-troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      5.5 GitOps Monitoring &amp; Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.5 GitOps Monitoring &amp; Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#monitor-gitops-crossplane-health" class="md-nav__link">
    <span class="md-ellipsis">
      Monitor GitOps + Crossplane Health
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-common-gitops-crossplane-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting Common GitOps + Crossplane Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-gitops-crossplane-integration-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: GitOps + Crossplane Integration Benefits
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 6: GitOps + Crossplane Integration Benefits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-end-to-end-workflow-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 End-to-End Workflow Visualization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-rock-solid-workflow-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 Rock-Solid Workflow Benefits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-check-environment-status" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 Check Environment Status
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-add-another-developer" class="md-nav__link">
    <span class="md-ellipsis">
      Step 7: Add Another Developer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#learning-outcomes" class="md-nav__link">
    <span class="md-ellipsis">
      Learning Outcomes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-concepts-introduced" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Concepts Introduced
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Concepts Introduced">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-design-principles" class="md-nav__link">
    <span class="md-ellipsis">
      API Design Principles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composition-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      Composition Techniques
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting-common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting Common Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting Common Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xrd-not-available" class="md-nav__link">
    <span class="md-ellipsis">
      XRD Not Available
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composition-not-working" class="md-nav__link">
    <span class="md-ellipsis">
      Composition Not Working
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resources-not-creating" class="md-nav__link">
    <span class="md-ellipsis">
      Resources Not Creating
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#platform-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Platform Documentation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Platform Documentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#developer-guide" class="md-nav__link">
    <span class="md-ellipsis">
      Developer Guide
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-you-get" class="md-nav__link">
    <span class="md-ellipsis">
      What You Get
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What You Get">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-structure-created" class="md-nav__link">
    <span class="md-ellipsis">
      File Structure Created
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="module-1-your-first-composition">Module 1: Your First Composition<a class="headerlink" href="#module-1-your-first-composition" title="Permanent link">&para;</a></h1>
<p><strong>Time:</strong> 45 minutes<br />
<strong>Objective:</strong> Build a reusable development environment API that developers can use to get complete infrastructure with a single YAML request</p>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>Individual Managed Resources are powerful, but creating complete environments requires multiple resources working together. <strong>Compositions</strong> solve this by bundling resources into reusable patterns with developer-friendly APIs.</p>
<p><strong>What you'll build:</strong>
- An <code>XDevEnvironment</code> API that creates Resource Group + Virtual Network
- Simple developer interface hiding Azure complexity
- GitOps deployment for the platform components
- Working example that others can copy and customize</p>
<h2 id="tutorial-approach-single-repository-learning">Tutorial Approach: Single Repository Learning<a class="headerlink" href="#tutorial-approach-single-repository-learning" title="Permanent link">&para;</a></h2>
<p>This tutorial uses a <strong>single repository approach</strong> to keep learning simple and focused. You'll work entirely within the cloned tutorial repository, avoiding the complexity of multi-repository setups.</p>
<p><strong>Why single repository for learning:</strong>
- <strong>Simplified workflow</strong>: No need to manage multiple repos, branches, or access controls
- <strong>Immediate feedback</strong>: See all components together in one place
- <strong>Easy experimentation</strong>: Modify, commit, and test in the same repository
- <strong>Clear structure</strong>: Understand separation of concerns without repo complexity</p>
<p><strong>Real-world considerations:</strong>
- <strong>Production setups</strong> often use separate repositories for platform components vs. application instances
- <strong>Multi-repo strategies</strong> enable different teams to own different parts
- <strong>This tutorial</strong> establishes patterns you can later split across repositories as needed</p>
<p><strong>Learning progression:</strong>
1. <strong>Learn concepts</strong> in this single repository
2. <strong>Understand patterns</strong> and relationships
3. <strong>Apply to production</strong> with appropriate repository separation later</p>
<h2 id="the-problem-were-solving">The Problem We're Solving<a class="headerlink" href="#the-problem-were-solving" title="Permanent link">&para;</a></h2>
<p>Currently, developers need to:
1. Create Resource Group
2. Create Virtual Network<br />
3. Configure subnets
4. Set up security groups
5. Remember all the configuration details</p>
<p><strong>After this module, they'll just write:</strong>
<div class="language-yaml highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform.tutorial.com/v1alpha1</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">XDevEnvironment</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alice-dev</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">  </span><span class="nt">parameters</span><span class="p">:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alice-dev</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">    </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eastus</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">  </span><span class="nt">crossplane</span><span class="p">:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">    </span><span class="nt">compositionRef</span><span class="p">:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev-environment-composition</span>
</code></pre></div></p>
<h2 id="step-1-apply-rock-solid-gitops-structure">Step 1: Apply Rock-Solid GitOps Structure<a class="headerlink" href="#step-1-apply-rock-solid-gitops-structure" title="Permanent link">&para;</a></h2>
<p>Following the <strong>GitHub Flow + Environment-Based Directory</strong> pattern from our GitOps fundamentals:</p>
<h3 id="11-create-gitops-ready-directory-structure">1.1 Create GitOps-Ready Directory Structure<a class="headerlink" href="#11-create-gitops-ready-directory-structure" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Platform components (shared, reusable)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>platform-core/xrds
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>platform-core/compositions
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>platform-core/functions
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c1"># Environment-specific deployments (follows GitOps workflow pattern)</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>environments/dev/infrastructure
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>environments/staging/infrastructure<span class="w">  </span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>environments/production/infrastructure
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="c1"># GitOps Applications (manages platform and environments)</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>applications/platform
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>applications/environments
</code></pre></div>
<p><strong>GitOps Structure Explanation:</strong>
- <strong><code>platform-core/</code></strong>: Platform components that serve all environments (XRDs, Compositions, Functions)
- <strong><code>environments/{env}/infrastructure/</code></strong>: Environment-specific Crossplane resource instances
- <strong><code>applications/platform/</code></strong>: ArgoCD Applications that manage platform components
- <strong><code>applications/environments/</code></strong>: ArgoCD Applications that manage environment instances</p>
<p>This structure supports the <strong>GitHub Flow workflow</strong> we established:
1. <strong>Feature branches</strong> modify platform components or environment configs
2. <strong>PR environments</strong> automatically test infrastructure changes in <code>dev</code>
3. <strong>Controlled promotion</strong> from dev → staging → production
4. <strong>Emergency hotfixes</strong> can bypass normal flow when needed</p>
<h3 id="12-platform-component-workflow-integration">1.2 Platform Component Workflow Integration<a class="headerlink" href="#12-platform-component-workflow-integration" title="Permanent link">&para;</a></h3>
<p><strong>Platform engineers</strong> work on reusable components:
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Feature branch for platform enhancement</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature/enhanced-dev-environment
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1"># Work on platform components</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>vim<span class="w"> </span>platform-core/xrds/dev-environment-xrd.yaml
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>vim<span class="w"> </span>platform-core/compositions/dev-environment-composition.yaml
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c1"># Commit platform changes</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>git<span class="w"> </span>add<span class="w"> </span>platform-core/
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;feat: enhance dev environment with networking support&quot;</span>
</code></pre></div></p>
<p><strong>Development teams</strong> create environment instances:
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Feature branch for new environment</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature/alice-dev-environment
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c1"># Create environment instance</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>vim<span class="w"> </span>environments/dev/infrastructure/alice-dev.yaml
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="c1"># Commit environment instance</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>git<span class="w"> </span>add<span class="w"> </span>environments/dev/infrastructure/
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;feat: create Alice&#39;s development environment&quot;</span>
</code></pre></div></p>
<h3 id="13-crossplane-in-the-gitops-promotion-pipeline">1.3 Crossplane in the GitOps Promotion Pipeline<a class="headerlink" href="#13-crossplane-in-the-gitops-promotion-pipeline" title="Permanent link">&para;</a></h3>
<p>Following our established <strong>Environment-Based Directory Structure</strong> pattern:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>graph LR
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    A[Feature Branch&lt;br/&gt;platform-core/*] --&gt; B[PR Testing&lt;br/&gt;dev environment]
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    B --&gt; C[Merge to Main&lt;br/&gt;Auto-deploy dev]
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    C --&gt; D[Manual Promotion&lt;br/&gt;dev → staging]  
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    D --&gt; E[Manual Promotion&lt;br/&gt;staging → production]
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    F[Environment Instance&lt;br/&gt;environments/dev/*] --&gt; B
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    G[Environment Config&lt;br/&gt;environments/staging/*] --&gt; D
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    H[Environment Config&lt;br/&gt;environments/production/*] --&gt; E
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>    style A fill:#e8f5e8
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>    style F fill:#e8f5e8
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>    style B fill:#fff3e0
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>    style C fill:#f0f7ff
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>    style D fill:#fff0f5
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>    style E fill:#fff5f5
</code></pre></div>
<p><strong>Key Integration Points:</strong>
- <strong>Platform components</strong> (XRDs, Compositions) are <strong>environment-agnostic</strong> and live in <code>platform-core/</code>
- <strong>Environment instances</strong> (XRs) are <strong>environment-specific</strong> and follow the promotion pipeline
- <strong>ArgoCD Applications</strong> manage both platform and environments using the same GitOps workflow
- <strong>Crossplane health checks</strong> integrate with ArgoCD sync status for end-to-end monitoring</p>
<h2 id="step-2-design-the-developer-api">Step 2: Design the Developer API<a class="headerlink" href="#step-2-design-the-developer-api" title="Permanent link">&para;</a></h2>
<p>The XRD defines what developers can request:</p>
<div class="language-yaml highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># platform-core/xrds/dev-environment-xrd.yaml</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apiextensions.crossplane.io/v2</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CompositeResourceDefinition</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xdevenvironments.platform.tutorial.com</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crossplane-tutorial</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">    </span><span class="nt">component</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xrd</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform.tutorial.com</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">  </span><span class="nt">names</span><span class="p">:</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">XDevEnvironment</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">    </span><span class="nt">plural</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xdevenvironments</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">  </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Namespaced</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">  </span><span class="nt">versions</span><span class="p">:</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1alpha1</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">    </span><span class="nt">served</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">    </span><span class="nt">referenceable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">    </span><span class="nt">schema</span><span class="p">:</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="w">      </span><span class="nt">openAPIV3Schema</span><span class="p">:</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="w">        </span><span class="nt">properties</span><span class="p">:</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="w">          </span><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="w">            </span><span class="nt">properties</span><span class="p">:</span>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a><span class="w">              </span><span class="nt">parameters</span><span class="p">:</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="w">                </span><span class="nt">properties</span><span class="p">:</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="w">                  </span><span class="nt">name</span><span class="p">:</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a><span class="w">                    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a><span class="w">                    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Name</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">development</span><span class="nv"> </span><span class="s">environment&quot;</span>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a><span class="w">                    </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;^[a-z0-9-]+$&#39;</span>
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a><span class="w">                    </span><span class="nt">minLength</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a><span class="w">                    </span><span class="nt">maxLength</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a><span class="w">                  </span><span class="nt">region</span><span class="p">:</span>
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a><span class="w">                    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a><span class="w">                    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Azure</span><span class="nv"> </span><span class="s">region</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">deployment&quot;</span>
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a><span class="w">                    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;eastus&quot;</span>
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a><span class="w">                    </span><span class="nt">enum</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;eastus&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;westus2&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;eastus2&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;westeurope&quot;</span><span class="p p-Indicator">]</span>
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a><span class="w">                  </span><span class="nt">resourceGroupLocation</span><span class="p">:</span>
<a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a><span class="w">                    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a><span class="w">                    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Specific</span><span class="nv"> </span><span class="s">location</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">Azure</span><span class="nv"> </span><span class="s">resource</span><span class="nv"> </span><span class="s">group&quot;</span>
<a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a><span class="w">                    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;East</span><span class="nv"> </span><span class="s">US&quot;</span>
<a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a><span class="w">                  </span><span class="nt">tags</span><span class="p">:</span>
<a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a><span class="w">                    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a><span class="w">                    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Additional</span><span class="nv"> </span><span class="s">tags</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">resources&quot;</span>
<a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a><span class="w">                    </span><span class="nt">additionalProperties</span><span class="p">:</span>
<a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a><span class="w">                      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a><span class="w">                </span><span class="nt">required</span><span class="p">:</span>
<a id="__codelineno-5-50" name="__codelineno-5-50" href="#__codelineno-5-50"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name</span>
<a id="__codelineno-5-51" name="__codelineno-5-51" href="#__codelineno-5-51"></a><span class="w">              </span><span class="nt">crossplane</span><span class="p">:</span>
<a id="__codelineno-5-52" name="__codelineno-5-52" href="#__codelineno-5-52"></a><span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-5-53" name="__codelineno-5-53" href="#__codelineno-5-53"></a><span class="w">                </span><span class="nt">properties</span><span class="p">:</span>
<a id="__codelineno-5-54" name="__codelineno-5-54" href="#__codelineno-5-54"></a><span class="w">                  </span><span class="nt">compositionRef</span><span class="p">:</span>
<a id="__codelineno-5-55" name="__codelineno-5-55" href="#__codelineno-5-55"></a><span class="w">                    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-5-56" name="__codelineno-5-56" href="#__codelineno-5-56"></a><span class="w">                    </span><span class="nt">properties</span><span class="p">:</span>
<a id="__codelineno-5-57" name="__codelineno-5-57" href="#__codelineno-5-57"></a><span class="w">                      </span><span class="nt">name</span><span class="p">:</span>
<a id="__codelineno-5-58" name="__codelineno-5-58" href="#__codelineno-5-58"></a><span class="w">                        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-5-59" name="__codelineno-5-59" href="#__codelineno-5-59"></a><span class="w">                    </span><span class="nt">required</span><span class="p">:</span>
<a id="__codelineno-5-60" name="__codelineno-5-60" href="#__codelineno-5-60"></a><span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name</span>
<a id="__codelineno-5-61" name="__codelineno-5-61" href="#__codelineno-5-61"></a><span class="w">                </span><span class="nt">required</span><span class="p">:</span>
<a id="__codelineno-5-62" name="__codelineno-5-62" href="#__codelineno-5-62"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compositionRef</span>
<a id="__codelineno-5-63" name="__codelineno-5-63" href="#__codelineno-5-63"></a><span class="w">            </span><span class="nt">required</span><span class="p">:</span>
<a id="__codelineno-5-64" name="__codelineno-5-64" href="#__codelineno-5-64"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parameters</span>
<a id="__codelineno-5-65" name="__codelineno-5-65" href="#__codelineno-5-65"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crossplane</span>
<a id="__codelineno-5-66" name="__codelineno-5-66" href="#__codelineno-5-66"></a><span class="w">          </span><span class="nt">status</span><span class="p">:</span>
<a id="__codelineno-5-67" name="__codelineno-5-67" href="#__codelineno-5-67"></a><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-5-68" name="__codelineno-5-68" href="#__codelineno-5-68"></a><span class="w">            </span><span class="nt">properties</span><span class="p">:</span>
<a id="__codelineno-5-69" name="__codelineno-5-69" href="#__codelineno-5-69"></a><span class="w">              </span><span class="nt">resourceGroupId</span><span class="p">:</span>
<a id="__codelineno-5-70" name="__codelineno-5-70" href="#__codelineno-5-70"></a><span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-5-71" name="__codelineno-5-71" href="#__codelineno-5-71"></a><span class="w">                </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Azure</span><span class="nv"> </span><span class="s">Resource</span><span class="nv"> </span><span class="s">Group</span><span class="nv"> </span><span class="s">ID&quot;</span>
<a id="__codelineno-5-72" name="__codelineno-5-72" href="#__codelineno-5-72"></a><span class="w">              </span><span class="nt">virtualNetworkId</span><span class="p">:</span>
<a id="__codelineno-5-73" name="__codelineno-5-73" href="#__codelineno-5-73"></a><span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-5-74" name="__codelineno-5-74" href="#__codelineno-5-74"></a><span class="w">                </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Azure</span><span class="nv"> </span><span class="s">Virtual</span><span class="nv"> </span><span class="s">Network</span><span class="nv"> </span><span class="s">ID&quot;</span>
<a id="__codelineno-5-75" name="__codelineno-5-75" href="#__codelineno-5-75"></a><span class="w">              </span><span class="nt">ready</span><span class="p">:</span>
<a id="__codelineno-5-76" name="__codelineno-5-76" href="#__codelineno-5-76"></a><span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">boolean</span>
<a id="__codelineno-5-77" name="__codelineno-5-77" href="#__codelineno-5-77"></a><span class="w">                </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Environment</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">ready</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">use&quot;</span>
</code></pre></div>
<blockquote>
<p>📁 <strong>Exercise Files</strong>: The complete XRD configuration is available at <a href="../../exercises/crossplane-advanced-patterns-01/platform-core/xrds/dev-environment-xrd.yaml"><code>exercises/crossplane-advanced-patterns-01/platform-core/xrds/dev-environment-xrd.yaml</code></a></p>
</blockquote>
<p><strong>Key XRD concepts explained:</strong></p>
<ul>
<li><strong><code>group</code> and <code>names</code></strong>: Define the API endpoint (like <code>apps/v1</code> for Deployments)</li>
<li><strong><code>scope</code></strong>: Namespaced by default in v2 for better isolation and multi-tenancy</li>
<li><strong><code>schema</code></strong>: OpenAPI schema with validation rules</li>
<li><strong><code>parameters</code></strong>: Simple interface hiding Azure complexity</li>
<li><strong><code>crossplane</code></strong>: v2 structure containing composition references and resource management</li>
<li><strong><code>status</code></strong>: Information exposed back to developers</li>
</ul>
<h3 id="13-understanding-namespaced-composite-resources-in-v2">1.3 Understanding Namespaced Composite Resources in v2<a class="headerlink" href="#13-understanding-namespaced-composite-resources-in-v2" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>graph TD
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    A[Developer creates&lt;br/&gt;XDevEnvironment&lt;br/&gt;in namespace] --&gt; B[Crossplane processes&lt;br/&gt;Composite Resource]
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    B --&gt; C[Composition creates&lt;br/&gt;ResourceGroup]
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    B --&gt; D[Composition creates&lt;br/&gt;VirtualNetwork]
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    style A fill:#e8f5e8
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>    style B fill:#fff3e0
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>    style C fill:#e1f5fe
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>    style D fill:#e1f5fe
</code></pre></div>
<p><strong>Composite Resources</strong> (<code>XDevEnvironment</code>): What developers create directly in namespaces
<strong>Managed Resources</strong>: The actual Azure resources created by compositions</p>
<h2 id="step-2-build-the-function-based-composition">Step 2: Build the Function-Based Composition<a class="headerlink" href="#step-2-build-the-function-based-composition" title="Permanent link">&para;</a></h2>
<p>Crossplane v2 uses function pipelines for composition logic. First, we need to install the required function:</p>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># Install the patch-and-transform function</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="s">apiVersion: pkg.crossplane.io/v1beta1</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="s">kind: Function</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="s">metadata:</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="s">  name: function-patch-and-transform</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="s">spec:</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="s">  package: xpkg.upbound.io/crossplane-contrib/function-patch-and-transform:v0.2.1</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="s">EOF</span>
</code></pre></div>
<p>Now we define HOW to build the environment using function pipelines:</p>
<div class="language-yaml highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># platform-core/compositions/dev-environment-composition.yaml</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apiextensions.crossplane.io/v1</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Composition</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev-environment-azure</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">development</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crossplane-tutorial</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="w">  </span><span class="nt">compositeTypeRef</span><span class="p">:</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="w">    </span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform.tutorial.com/v1alpha1</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">XDevEnvironment</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">  </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pipeline</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">  </span><span class="nt">pipeline</span><span class="p">:</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">patch-and-transform</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">    </span><span class="nt">functionRef</span><span class="p">:</span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">function-patch-and-transform</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">    </span><span class="nt">input</span><span class="p">:</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="w">      </span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pt.fn.crossplane.io/v1beta1</span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="w">      </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Resources</span>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="w">      </span><span class="nt">resources</span><span class="p">:</span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resource-group</span>
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="w">        </span><span class="nt">base</span><span class="p">:</span>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="w">          </span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure.upbound.io/v1beta1</span>
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="w">          </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ResourceGroup</span>
<a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a><span class="w">          </span><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="w">            </span><span class="nt">forProvider</span><span class="p">:</span>
<a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="w">              </span><span class="nt">tags</span><span class="p">:</span>
<a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a><span class="w">                </span><span class="nt">managed-by</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crossplane</span>
<a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a><span class="w">                </span><span class="nt">environment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">development</span>
<a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a><span class="w">                </span><span class="nt">created-by</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crossplane-tutorial</span>
<a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a><span class="w">        </span><span class="nt">patches</span><span class="p">:</span>
<a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a><span class="w">        </span><span class="c1"># Copy environment name to resource group name</span>
<a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FromCompositeFieldPath</span>
<a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a><span class="w">          </span><span class="nt">fromFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.parameters.name</span>
<a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a><span class="w">          </span><span class="nt">toFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metadata.name</span>
<a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a><span class="w">          </span><span class="nt">transforms</span><span class="p">:</span>
<a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-8-41" name="__codelineno-8-41" href="#__codelineno-8-41"></a><span class="w">            </span><span class="nt">string</span><span class="p">:</span>
<a id="__codelineno-8-42" name="__codelineno-8-42" href="#__codelineno-8-42"></a><span class="w">              </span><span class="nt">fmt</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;%s-rg&quot;</span>
<a id="__codelineno-8-43" name="__codelineno-8-43" href="#__codelineno-8-43"></a>
<a id="__codelineno-8-44" name="__codelineno-8-44" href="#__codelineno-8-44"></a><span class="w">        </span><span class="c1"># Copy region to Azure location</span>
<a id="__codelineno-8-45" name="__codelineno-8-45" href="#__codelineno-8-45"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FromCompositeFieldPath</span>
<a id="__codelineno-8-46" name="__codelineno-8-46" href="#__codelineno-8-46"></a><span class="w">          </span><span class="nt">fromFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.parameters.resourceGroupLocation</span>
<a id="__codelineno-8-47" name="__codelineno-8-47" href="#__codelineno-8-47"></a><span class="w">          </span><span class="nt">toFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.forProvider.location</span>
<a id="__codelineno-8-48" name="__codelineno-8-48" href="#__codelineno-8-48"></a>
<a id="__codelineno-8-49" name="__codelineno-8-49" href="#__codelineno-8-49"></a><span class="w">        </span><span class="c1"># Add environment name to tags</span>
<a id="__codelineno-8-50" name="__codelineno-8-50" href="#__codelineno-8-50"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FromCompositeFieldPath</span>
<a id="__codelineno-8-51" name="__codelineno-8-51" href="#__codelineno-8-51"></a><span class="w">          </span><span class="nt">fromFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.parameters.name</span>
<a id="__codelineno-8-52" name="__codelineno-8-52" href="#__codelineno-8-52"></a><span class="w">          </span><span class="nt">toFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.forProvider.tags[&quot;environment-name&quot;]</span>
<a id="__codelineno-8-53" name="__codelineno-8-53" href="#__codelineno-8-53"></a>
<a id="__codelineno-8-54" name="__codelineno-8-54" href="#__codelineno-8-54"></a><span class="w">        </span><span class="c1"># Merge user-provided tags</span>
<a id="__codelineno-8-55" name="__codelineno-8-55" href="#__codelineno-8-55"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FromCompositeFieldPath</span>
<a id="__codelineno-8-56" name="__codelineno-8-56" href="#__codelineno-8-56"></a><span class="w">          </span><span class="nt">fromFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.parameters.tags</span>
<a id="__codelineno-8-57" name="__codelineno-8-57" href="#__codelineno-8-57"></a><span class="w">          </span><span class="nt">toFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.forProvider.tags</span>
<a id="__codelineno-8-58" name="__codelineno-8-58" href="#__codelineno-8-58"></a><span class="w">          </span><span class="nt">policy</span><span class="p">:</span>
<a id="__codelineno-8-59" name="__codelineno-8-59" href="#__codelineno-8-59"></a><span class="w">            </span><span class="nt">mergeOptions</span><span class="p">:</span>
<a id="__codelineno-8-60" name="__codelineno-8-60" href="#__codelineno-8-60"></a><span class="w">              </span><span class="nt">keepMapValues</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-8-61" name="__codelineno-8-61" href="#__codelineno-8-61"></a>
<a id="__codelineno-8-62" name="__codelineno-8-62" href="#__codelineno-8-62"></a><span class="w">        </span><span class="c1"># Report back the resource group ID</span>
<a id="__codelineno-8-63" name="__codelineno-8-63" href="#__codelineno-8-63"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ToCompositeFieldPath</span>
<a id="__codelineno-8-64" name="__codelineno-8-64" href="#__codelineno-8-64"></a><span class="w">          </span><span class="nt">fromFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status.atProvider.id</span>
<a id="__codelineno-8-65" name="__codelineno-8-65" href="#__codelineno-8-65"></a><span class="w">          </span><span class="nt">toFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status.resourceGroupId</span>
<a id="__codelineno-8-66" name="__codelineno-8-66" href="#__codelineno-8-66"></a>
<a id="__codelineno-8-67" name="__codelineno-8-67" href="#__codelineno-8-67"></a><span class="w">        </span><span class="c1"># Set readiness condition</span>
<a id="__codelineno-8-68" name="__codelineno-8-68" href="#__codelineno-8-68"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ToCompositeFieldPath</span>
<a id="__codelineno-8-69" name="__codelineno-8-69" href="#__codelineno-8-69"></a><span class="w">          </span><span class="nt">fromFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status.conditions[?(@.type==&quot;Ready&quot;)].status</span>
<a id="__codelineno-8-70" name="__codelineno-8-70" href="#__codelineno-8-70"></a><span class="w">          </span><span class="nt">toFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status.ready</span>
<a id="__codelineno-8-71" name="__codelineno-8-71" href="#__codelineno-8-71"></a><span class="w">          </span><span class="nt">transforms</span><span class="p">:</span>
<a id="__codelineno-8-72" name="__codelineno-8-72" href="#__codelineno-8-72"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">convert</span>
<a id="__codelineno-8-73" name="__codelineno-8-73" href="#__codelineno-8-73"></a><span class="w">            </span><span class="nt">convert</span><span class="p">:</span>
<a id="__codelineno-8-74" name="__codelineno-8-74" href="#__codelineno-8-74"></a><span class="w">              </span><span class="nt">toType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bool</span>
<a id="__codelineno-8-75" name="__codelineno-8-75" href="#__codelineno-8-75"></a>
<a id="__codelineno-8-76" name="__codelineno-8-76" href="#__codelineno-8-76"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">virtual-network</span>
<a id="__codelineno-8-77" name="__codelineno-8-77" href="#__codelineno-8-77"></a><span class="w">        </span><span class="nt">base</span><span class="p">:</span>
<a id="__codelineno-8-78" name="__codelineno-8-78" href="#__codelineno-8-78"></a><span class="w">          </span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network.azure.upbound.io/v1beta1</span>
<a id="__codelineno-8-79" name="__codelineno-8-79" href="#__codelineno-8-79"></a><span class="w">          </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VirtualNetwork</span>
<a id="__codelineno-8-80" name="__codelineno-8-80" href="#__codelineno-8-80"></a><span class="w">          </span><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-8-81" name="__codelineno-8-81" href="#__codelineno-8-81"></a><span class="w">            </span><span class="nt">forProvider</span><span class="p">:</span>
<a id="__codelineno-8-82" name="__codelineno-8-82" href="#__codelineno-8-82"></a><span class="w">              </span><span class="nt">addressSpace</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;10.0.0.0/16&quot;</span><span class="p p-Indicator">]</span>
<a id="__codelineno-8-83" name="__codelineno-8-83" href="#__codelineno-8-83"></a><span class="w">              </span><span class="nt">tags</span><span class="p">:</span>
<a id="__codelineno-8-84" name="__codelineno-8-84" href="#__codelineno-8-84"></a><span class="w">                </span><span class="nt">managed-by</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crossplane</span>
<a id="__codelineno-8-85" name="__codelineno-8-85" href="#__codelineno-8-85"></a><span class="w">                </span><span class="nt">environment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">development</span>
<a id="__codelineno-8-86" name="__codelineno-8-86" href="#__codelineno-8-86"></a><span class="w">                </span><span class="nt">resource-type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">virtual-network</span>
<a id="__codelineno-8-87" name="__codelineno-8-87" href="#__codelineno-8-87"></a><span class="w">        </span><span class="nt">patches</span><span class="p">:</span>
<a id="__codelineno-8-88" name="__codelineno-8-88" href="#__codelineno-8-88"></a><span class="w">        </span><span class="c1"># Copy environment name to VNet name</span>
<a id="__codelineno-8-89" name="__codelineno-8-89" href="#__codelineno-8-89"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FromCompositeFieldPath</span>
<a id="__codelineno-8-90" name="__codelineno-8-90" href="#__codelineno-8-90"></a><span class="w">          </span><span class="nt">fromFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.parameters.name</span>
<a id="__codelineno-8-91" name="__codelineno-8-91" href="#__codelineno-8-91"></a><span class="w">          </span><span class="nt">toFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metadata.name</span>
<a id="__codelineno-8-92" name="__codelineno-8-92" href="#__codelineno-8-92"></a><span class="w">          </span><span class="nt">transforms</span><span class="p">:</span>
<a id="__codelineno-8-93" name="__codelineno-8-93" href="#__codelineno-8-93"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-8-94" name="__codelineno-8-94" href="#__codelineno-8-94"></a><span class="w">            </span><span class="nt">string</span><span class="p">:</span>
<a id="__codelineno-8-95" name="__codelineno-8-95" href="#__codelineno-8-95"></a><span class="w">              </span><span class="nt">fmt</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;%s-vnet&quot;</span>
<a id="__codelineno-8-96" name="__codelineno-8-96" href="#__codelineno-8-96"></a>
<a id="__codelineno-8-97" name="__codelineno-8-97" href="#__codelineno-8-97"></a><span class="w">        </span><span class="c1"># Reference the resource group by name</span>
<a id="__codelineno-8-98" name="__codelineno-8-98" href="#__codelineno-8-98"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FromCompositeFieldPath</span>
<a id="__codelineno-8-99" name="__codelineno-8-99" href="#__codelineno-8-99"></a><span class="w">          </span><span class="nt">fromFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.parameters.name</span>
<a id="__codelineno-8-100" name="__codelineno-8-100" href="#__codelineno-8-100"></a><span class="w">          </span><span class="nt">toFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.forProvider.resourceGroupName</span>
<a id="__codelineno-8-101" name="__codelineno-8-101" href="#__codelineno-8-101"></a><span class="w">          </span><span class="nt">transforms</span><span class="p">:</span>
<a id="__codelineno-8-102" name="__codelineno-8-102" href="#__codelineno-8-102"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-8-103" name="__codelineno-8-103" href="#__codelineno-8-103"></a><span class="w">            </span><span class="nt">string</span><span class="p">:</span>
<a id="__codelineno-8-104" name="__codelineno-8-104" href="#__codelineno-8-104"></a><span class="w">              </span><span class="nt">fmt</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;%s-rg&quot;</span>
<a id="__codelineno-8-105" name="__codelineno-8-105" href="#__codelineno-8-105"></a>
<a id="__codelineno-8-106" name="__codelineno-8-106" href="#__codelineno-8-106"></a><span class="w">        </span><span class="c1"># Copy region to Azure location</span>
<a id="__codelineno-8-107" name="__codelineno-8-107" href="#__codelineno-8-107"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FromCompositeFieldPath</span>
<a id="__codelineno-8-108" name="__codelineno-8-108" href="#__codelineno-8-108"></a><span class="w">          </span><span class="nt">fromFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.parameters.resourceGroupLocation</span>
<a id="__codelineno-8-109" name="__codelineno-8-109" href="#__codelineno-8-109"></a><span class="w">          </span><span class="nt">toFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.forProvider.location</span>
<a id="__codelineno-8-110" name="__codelineno-8-110" href="#__codelineno-8-110"></a>
<a id="__codelineno-8-111" name="__codelineno-8-111" href="#__codelineno-8-111"></a><span class="w">        </span><span class="c1"># Add environment name to tags</span>
<a id="__codelineno-8-112" name="__codelineno-8-112" href="#__codelineno-8-112"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FromCompositeFieldPath</span>
<a id="__codelineno-8-113" name="__codelineno-8-113" href="#__codelineno-8-113"></a><span class="w">          </span><span class="nt">fromFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.parameters.name</span>
<a id="__codelineno-8-114" name="__codelineno-8-114" href="#__codelineno-8-114"></a><span class="w">          </span><span class="nt">toFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.forProvider.tags[&quot;environment-name&quot;]</span>
<a id="__codelineno-8-115" name="__codelineno-8-115" href="#__codelineno-8-115"></a>
<a id="__codelineno-8-116" name="__codelineno-8-116" href="#__codelineno-8-116"></a><span class="w">        </span><span class="c1"># Merge user-provided tags</span>
<a id="__codelineno-8-117" name="__codelineno-8-117" href="#__codelineno-8-117"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FromCompositeFieldPath</span>
<a id="__codelineno-8-118" name="__codelineno-8-118" href="#__codelineno-8-118"></a><span class="w">          </span><span class="nt">fromFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.parameters.tags</span>
<a id="__codelineno-8-119" name="__codelineno-8-119" href="#__codelineno-8-119"></a><span class="w">          </span><span class="nt">toFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.forProvider.tags</span>
<a id="__codelineno-8-120" name="__codelineno-8-120" href="#__codelineno-8-120"></a><span class="w">          </span><span class="nt">policy</span><span class="p">:</span>
<a id="__codelineno-8-121" name="__codelineno-8-121" href="#__codelineno-8-121"></a><span class="w">            </span><span class="nt">mergeOptions</span><span class="p">:</span>
<a id="__codelineno-8-122" name="__codelineno-8-122" href="#__codelineno-8-122"></a><span class="w">              </span><span class="nt">keepMapValues</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-8-123" name="__codelineno-8-123" href="#__codelineno-8-123"></a>
<a id="__codelineno-8-124" name="__codelineno-8-124" href="#__codelineno-8-124"></a><span class="w">        </span><span class="c1"># Report back the VNet ID</span>
<a id="__codelineno-8-125" name="__codelineno-8-125" href="#__codelineno-8-125"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ToCompositeFieldPath</span>
<a id="__codelineno-8-126" name="__codelineno-8-126" href="#__codelineno-8-126"></a><span class="w">          </span><span class="nt">fromFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status.atProvider.id</span>
<a id="__codelineno-8-127" name="__codelineno-8-127" href="#__codelineno-8-127"></a><span class="w">          </span><span class="nt">toFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status.virtualNetworkId</span>
</code></pre></div>
<blockquote>
<p>📁 <strong>Exercise Files</strong>: The complete Composition configuration is available at <a href="../../exercises/crossplane-advanced-patterns-01/platform-core/compositions/dev-environment-composition.yaml"><code>exercises/crossplane-advanced-patterns-01/platform-core/compositions/dev-environment-composition.yaml</code></a></p>
</blockquote>
<p><strong>v2 Composition concepts explained:</strong></p>
<ul>
<li><strong><code>mode: Pipeline</code></strong>: v2 function-based composition approach</li>
<li><strong><code>pipeline</code></strong>: Ordered sequence of functions to execute</li>
<li><strong><code>functionRef</code></strong>: Reference to installed composition function</li>
<li><strong><code>input</code></strong>: Function-specific configuration and resources</li>
<li><strong><code>compositeTypeRef</code></strong>: Links to the XRD we created</li>
</ul>
<h3 id="patch-types-deep-dive">Patch Types Deep Dive<a class="headerlink" href="#patch-types-deep-dive" title="Permanent link">&para;</a></h3>
<h4 id="fromcompositefieldpath"><code>FromCompositeFieldPath</code><a class="headerlink" href="#fromcompositefieldpath" title="Permanent link">&para;</a></h4>
<p>Copies values from the developer's request to the resource:
<div class="language-yaml highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nt">fromFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.parameters.name</span><span class="w">    </span><span class="c1"># From XDevEnvironment</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="nt">toFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metadata.name</span><span class="w">             </span><span class="c1"># To ResourceGroup</span>
</code></pre></div></p>
<h4 id="tocompositefieldpath"><code>ToCompositeFieldPath</code><a class="headerlink" href="#tocompositefieldpath" title="Permanent link">&para;</a></h4>
<p>Reports information back to the developer:
<div class="language-yaml highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nt">fromFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status.atProvider.id</span><span class="w">    </span><span class="c1"># From Azure</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="nt">toFieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status.resourceGroupId</span><span class="w">    </span><span class="c1"># To XDevEnvironment status</span>
</code></pre></div></p>
<h4 id="transforms">Transforms<a class="headerlink" href="#transforms" title="Permanent link">&para;</a></h4>
<p>Modify values during patching:
<div class="language-yaml highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nt">transforms</span><span class="p">:</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">  </span><span class="nt">string</span><span class="p">:</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">    </span><span class="nt">fmt</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;%s-rg&quot;</span><span class="w">  </span><span class="c1"># Append &quot;-rg&quot; to the name</span>
</code></pre></div></p>
<h2 id="step-3-create-argocd-applications">Step 3: Create ArgoCD Applications<a class="headerlink" href="#step-3-create-argocd-applications" title="Permanent link">&para;</a></h2>
<p>Create ArgoCD Applications to manage the platform components via GitOps:</p>
<div class="language-yaml highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># applications/platform/platform-apis.yaml</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Application</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform-xrds</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">argocd</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crossplane-tutorial</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">    </span><span class="nt">component</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform-apis</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">  </span><span class="nt">finalizers</span><span class="p">:</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resources-finalizer.argocd.argoproj.io</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="w">  </span><span class="nt">project</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="w">  </span><span class="nt">source</span><span class="p">:</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="w">    </span><span class="nt">repoURL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">__YOUR_PLATFORM_GITOPS_REPO_URL__</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="w">    </span><span class="nt">targetRevision</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HEAD</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform-core/xrds</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="w">  </span><span class="nt">destination</span><span class="p">:</span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://kubernetes.default.svc</span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crossplane-system</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="w">  </span><span class="nt">syncPolicy</span><span class="p">:</span>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="w">    </span><span class="nt">automated</span><span class="p">:</span>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="w">      </span><span class="nt">prune</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="w">      </span><span class="nt">selfHeal</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="w">    </span><span class="nt">syncOptions</span><span class="p">:</span>
<a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CreateNamespace=true</span>
<a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ApplyOutOfSyncOnly=true</span>
<a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a><span class="nn">---</span>
<a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Application</span>
<a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform-compositions</span>
<a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">argocd</span>
<a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-12-35" name="__codelineno-12-35" href="#__codelineno-12-35"></a><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crossplane-tutorial</span>
<a id="__codelineno-12-36" name="__codelineno-12-36" href="#__codelineno-12-36"></a><span class="w">    </span><span class="nt">component</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform-logic</span>
<a id="__codelineno-12-37" name="__codelineno-12-37" href="#__codelineno-12-37"></a><span class="w">  </span><span class="nt">finalizers</span><span class="p">:</span>
<a id="__codelineno-12-38" name="__codelineno-12-38" href="#__codelineno-12-38"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resources-finalizer.argocd.argoproj.io</span>
<a id="__codelineno-12-39" name="__codelineno-12-39" href="#__codelineno-12-39"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-12-40" name="__codelineno-12-40" href="#__codelineno-12-40"></a><span class="w">  </span><span class="nt">project</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<a id="__codelineno-12-41" name="__codelineno-12-41" href="#__codelineno-12-41"></a><span class="w">  </span><span class="nt">source</span><span class="p">:</span>
<a id="__codelineno-12-42" name="__codelineno-12-42" href="#__codelineno-12-42"></a><span class="w">    </span><span class="nt">repoURL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">__YOUR_PLATFORM_GITOPS_REPO_URL__</span>
<a id="__codelineno-12-43" name="__codelineno-12-43" href="#__codelineno-12-43"></a><span class="w">    </span><span class="nt">targetRevision</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HEAD</span>
<a id="__codelineno-12-44" name="__codelineno-12-44" href="#__codelineno-12-44"></a><span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform-core/compositions</span>
<a id="__codelineno-12-45" name="__codelineno-12-45" href="#__codelineno-12-45"></a><span class="w">  </span><span class="nt">destination</span><span class="p">:</span>
<a id="__codelineno-12-46" name="__codelineno-12-46" href="#__codelineno-12-46"></a><span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://kubernetes.default.svc</span>
<a id="__codelineno-12-47" name="__codelineno-12-47" href="#__codelineno-12-47"></a><span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crossplane-system</span>
<a id="__codelineno-12-48" name="__codelineno-12-48" href="#__codelineno-12-48"></a><span class="w">  </span><span class="nt">syncPolicy</span><span class="p">:</span>
<a id="__codelineno-12-49" name="__codelineno-12-49" href="#__codelineno-12-49"></a><span class="w">    </span><span class="nt">automated</span><span class="p">:</span>
<a id="__codelineno-12-50" name="__codelineno-12-50" href="#__codelineno-12-50"></a><span class="w">      </span><span class="nt">prune</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-12-51" name="__codelineno-12-51" href="#__codelineno-12-51"></a><span class="w">      </span><span class="nt">selfHeal</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-12-52" name="__codelineno-12-52" href="#__codelineno-12-52"></a><span class="w">    </span><span class="nt">syncOptions</span><span class="p">:</span>
<a id="__codelineno-12-53" name="__codelineno-12-53" href="#__codelineno-12-53"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CreateNamespace=true</span>
<a id="__codelineno-12-54" name="__codelineno-12-54" href="#__codelineno-12-54"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ApplyOutOfSyncOnly=true</span>
</code></pre></div>
<blockquote>
<p>📁 <strong>Exercise Files</strong>: The complete ArgoCD Applications configuration is available at <a href="../../exercises/crossplane-advanced-patterns-01/applications/platform/platform-apis.yaml"><code>exercises/crossplane-advanced-patterns-01/applications/platform/platform-apis.yaml</code></a></p>
</blockquote>
<h2 id="step-4-deploy-the-platform">Step 4: Deploy the Platform<a class="headerlink" href="#step-4-deploy-the-platform" title="Permanent link">&para;</a></h2>
<h3 id="41-update-repository-urls">4.1 Update Repository URLs<a class="headerlink" href="#41-update-repository-urls" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Replace with your actual repository URL (this tutorial repository)</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TUTORIAL_REPO_URL</span><span class="o">=</span><span class="s2">&quot;https://github.com/your-username/your-tutorial-repo.git&quot;</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s|__YOUR_PLATFORM_GITOPS_REPO_URL__|</span><span class="nv">$TUTORIAL_REPO_URL</span><span class="s2">|g&quot;</span><span class="w"> </span>applications/platform/platform-apis.yaml
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="c1"># Add all platform files</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>git<span class="w"> </span>add<span class="w"> </span>platform-core/xrds/dev-environment-xrd.yaml
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>git<span class="w"> </span>add<span class="w"> </span>platform-core/compositions/dev-environment-composition.yaml
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>git<span class="w"> </span>add<span class="w"> </span>applications/platform/platform-apis.yaml
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;feat: add XDevEnvironment platform API</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="s2">- XRD defines namespaced composite resource</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="s2">- Function-based composition with Azure resources</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="s2">- ArgoCD applications for GitOps deployment&quot;</span>
</code></pre></div>
<h3 id="42-commit-platform-components">4.2 Commit Platform Components<a class="headerlink" href="#42-commit-platform-components" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Add all platform files</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>git<span class="w"> </span>add<span class="w"> </span>platform-core/xrds/
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>git<span class="w"> </span>add<span class="w"> </span>platform-core/compositions/
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>git<span class="w"> </span>add<span class="w"> </span>platform-core/applications/platform-apis.yaml
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="c1"># Commit with descriptive message</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;feat: add XDevEnvironment platform API</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="s2">- XRD defines namespaced composite resource</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="s2">- Function-based composition with Azure resources</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="s2">- ArgoCD applications for GitOps deployment&quot;</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="c1"># Push to trigger GitOps deployment</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>git<span class="w"> </span>push
</code></pre></div>
<h3 id="43-deploy-argocd-applications">4.3 Deploy ArgoCD Applications<a class="headerlink" href="#43-deploy-argocd-applications" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Deploy the platform applications</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>applications/platform/platform-apis.yaml
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="c1"># Watch applications sync</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>kubectl<span class="w"> </span>get<span class="w"> </span>applications<span class="w"> </span>-n<span class="w"> </span>argocd<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>platform
</code></pre></div>
<h3 id="44-verify-platform-installation">4.4 Verify Platform Installation<a class="headerlink" href="#44-verify-platform-installation" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># Check XRD installation</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>kubectl<span class="w"> </span>get<span class="w"> </span>xrd
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>kubectl<span class="w"> </span>describe<span class="w"> </span>xrd<span class="w"> </span>xdevenvironments.platform.tutorial.com
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="c1"># Check Composition installation  </span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>kubectl<span class="w"> </span>get<span class="w"> </span>composition
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>kubectl<span class="w"> </span>describe<span class="w"> </span>composition<span class="w"> </span>dev-environment-azure
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="c1"># Verify APIs are available</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>kubectl<span class="w"> </span>api-resources<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>platform.tutorial.com
</code></pre></div>
<p>Expected output:
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>xdevenvironments    platform.tutorial.com/v1alpha1    true    XDevEnvironment
</code></pre></div></p>
<h2 id="step-5-apply-gitops-workflow-to-crossplane">Step 5: Apply GitOps Workflow to Crossplane! 🎉<a class="headerlink" href="#step-5-apply-gitops-workflow-to-crossplane" title="Permanent link">&para;</a></h2>
<p>Now let's demonstrate the <strong>complete GitOps workflow</strong> with Crossplane environments:</p>
<h3 id="51-github-flow-create-development-environment">5.1 GitHub Flow: Create Development Environment<a class="headerlink" href="#51-github-flow-create-development-environment" title="Permanent link">&para;</a></h3>
<p>Following our <strong>GitHub Flow + Environment-Based</strong> pattern:</p>
<h4 id="development-team-workflow">Development Team Workflow<a class="headerlink" href="#development-team-workflow" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># 1. Create feature branch for new environment</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature/alice-dev-environment
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c1"># 2. Create environment instance in dev directory  </span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>environments/dev/infrastructure/alice-dev.yaml<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="s">apiVersion: platform.tutorial.com/v1alpha1</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="s">kind: XDevEnvironment</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="s">metadata:</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="s">  name: alice-dev</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="s">  namespace: dev</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="s">  labels:</span>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="s">    app: crossplane-tutorial</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="s">    owner: alice</span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="s">    team: platform</span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="s">    environment: dev</span>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="s">spec:</span>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="s">  parameters:</span>
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="s">    name: alice-dev</span>
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a><span class="s">    region: eastus</span>
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a><span class="s">    resourceGroupLocation: &quot;East US&quot;</span>
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a><span class="s">    tags:</span>
<a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a><span class="s">      owner: alice</span>
<a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a><span class="s">      team: platform</span>
<a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a><span class="s">      cost-center: &quot;1234&quot;</span>
<a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a><span class="s">      purpose: development</span>
<a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a><span class="s">      environment: dev</span>
<a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a><span class="s">  crossplane:</span>
<a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a><span class="s">    compositionRef:</span>
<a id="__codelineno-18-29" name="__codelineno-18-29" href="#__codelineno-18-29"></a><span class="s">      name: dev-environment-azure</span>
<a id="__codelineno-18-30" name="__codelineno-18-30" href="#__codelineno-18-30"></a><span class="s">EOF</span>
<a id="__codelineno-18-31" name="__codelineno-18-31" href="#__codelineno-18-31"></a>
<a id="__codelineno-18-32" name="__codelineno-18-32" href="#__codelineno-18-32"></a><span class="c1"># 3. Commit and push to trigger PR workflow</span>
<a id="__codelineno-18-33" name="__codelineno-18-33" href="#__codelineno-18-33"></a>git<span class="w"> </span>add<span class="w"> </span>environments/dev/infrastructure/alice-dev.yaml
<a id="__codelineno-18-34" name="__codelineno-18-34" href="#__codelineno-18-34"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;feat: create Alice&#39;s development environment</span>
<a id="__codelineno-18-35" name="__codelineno-18-35" href="#__codelineno-18-35"></a>
<a id="__codelineno-18-36" name="__codelineno-18-36" href="#__codelineno-18-36"></a><span class="s2">- Creates Resource Group + VNet in East US</span>
<a id="__codelineno-18-37" name="__codelineno-18-37" href="#__codelineno-18-37"></a><span class="s2">- Configured for development workloads  </span>
<a id="__codelineno-18-38" name="__codelineno-18-38" href="#__codelineno-18-38"></a><span class="s2">- Tagged for cost tracking and ownership&quot;</span>
<a id="__codelineno-18-39" name="__codelineno-18-39" href="#__codelineno-18-39"></a>git<span class="w"> </span>push<span class="w"> </span>-u<span class="w"> </span>origin<span class="w"> </span>feature/alice-dev-environment
</code></pre></div>
<blockquote>
<p>📁 <strong>Exercise Files</strong>: The complete environment configuration is available at <a href="../../exercises/crossplane-advanced-patterns-01/environments/dev/infrastructure/alice-dev.yaml"><code>exercises/crossplane-advanced-patterns-01/environments/dev/infrastructure/alice-dev.yaml</code></a></p>
</blockquote>
<h4 id="automatic-pr-environment-testing">Automatic PR Environment Testing<a class="headerlink" href="#automatic-pr-environment-testing" title="Permanent link">&para;</a></h4>
<p><strong>GitHub Actions</strong> automatically creates a <strong>PR-specific environment</strong> for testing:</p>
<div class="language-yaml highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># .github/workflows/crossplane-pr-testing.yml</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Crossplane Infrastructure PR Testing</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="nt">on</span><span class="p">:</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">    </span><span class="nt">paths</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;environments/dev/infrastructure/**&#39;</span><span class="p p-Indicator">]</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="nt">jobs</span><span class="p">:</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">  </span><span class="nt">test-crossplane-infrastructure</span><span class="p">:</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Setup kubectl and ArgoCD CLI</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure/setup-kubectl@v3</span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create PR Environment Suffix</span>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="w">        </span><span class="no">export PR_SUFFIX=&quot;pr-${{ github.event.number }}&quot;</span>
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a><span class="w">        </span><span class="no">echo &quot;PR_SUFFIX=${PR_SUFFIX}&quot; &gt;&gt; $GITHUB_ENV</span>
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>
<a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deploy PR-specific Infrastructure</span>
<a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a><span class="w">        </span><span class="no"># Create PR-specific version of the environment</span>
<a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a><span class="w">        </span><span class="no">sed &quot;s/name: alice-dev/name: alice-dev-${PR_SUFFIX}/&quot; \</span>
<a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a><span class="w">            </span><span class="no">environments/dev/infrastructure/alice-dev.yaml | \</span>
<a id="__codelineno-19-26" name="__codelineno-19-26" href="#__codelineno-19-26"></a><span class="w">        </span><span class="no">sed &quot;s/namespace: dev/namespace: dev-pr-${{ github.event.number }}/&quot; | \</span>
<a id="__codelineno-19-27" name="__codelineno-19-27" href="#__codelineno-19-27"></a><span class="w">        </span><span class="no">kubectl apply -f -</span>
<a id="__codelineno-19-28" name="__codelineno-19-28" href="#__codelineno-19-28"></a>
<a id="__codelineno-19-29" name="__codelineno-19-29" href="#__codelineno-19-29"></a><span class="w">        </span><span class="no"># Wait for Crossplane resources to be ready</span>
<a id="__codelineno-19-30" name="__codelineno-19-30" href="#__codelineno-19-30"></a><span class="w">        </span><span class="no">kubectl wait --for=condition=Ready \</span>
<a id="__codelineno-19-31" name="__codelineno-19-31" href="#__codelineno-19-31"></a><span class="w">          </span><span class="no">xdevenvironment/alice-dev-${PR_SUFFIX} \</span>
<a id="__codelineno-19-32" name="__codelineno-19-32" href="#__codelineno-19-32"></a><span class="w">          </span><span class="no">-n dev-pr-${{ github.event.number }} \</span>
<a id="__codelineno-19-33" name="__codelineno-19-33" href="#__codelineno-19-33"></a><span class="w">          </span><span class="no">--timeout=600s</span>
<a id="__codelineno-19-34" name="__codelineno-19-34" href="#__codelineno-19-34"></a>
<a id="__codelineno-19-35" name="__codelineno-19-35" href="#__codelineno-19-35"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Validate Infrastructure</span>
<a id="__codelineno-19-36" name="__codelineno-19-36" href="#__codelineno-19-36"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-19-37" name="__codelineno-19-37" href="#__codelineno-19-37"></a><span class="w">        </span><span class="no"># Check that Crossplane created all expected resources</span>
<a id="__codelineno-19-38" name="__codelineno-19-38" href="#__codelineno-19-38"></a><span class="w">        </span><span class="no">kubectl get resourcegroups,virtualnetworks \</span>
<a id="__codelineno-19-39" name="__codelineno-19-39" href="#__codelineno-19-39"></a><span class="w">          </span><span class="no">-n dev-pr-${{ github.event.number }} \</span>
<a id="__codelineno-19-40" name="__codelineno-19-40" href="#__codelineno-19-40"></a><span class="w">          </span><span class="no">-l crossplane.io/composite=alice-dev-${PR_SUFFIX}</span>
<a id="__codelineno-19-41" name="__codelineno-19-41" href="#__codelineno-19-41"></a>
<a id="__codelineno-19-42" name="__codelineno-19-42" href="#__codelineno-19-42"></a><span class="w">        </span><span class="no"># Verify Azure resources exist (optional - requires Azure CLI)</span>
<a id="__codelineno-19-43" name="__codelineno-19-43" href="#__codelineno-19-43"></a><span class="w">        </span><span class="no"># az group show --name alice-dev-${PR_SUFFIX}-rg --output table</span>
<a id="__codelineno-19-44" name="__codelineno-19-44" href="#__codelineno-19-44"></a>
<a id="__codelineno-19-45" name="__codelineno-19-45" href="#__codelineno-19-45"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Cleanup PR Environment</span>
<a id="__codelineno-19-46" name="__codelineno-19-46" href="#__codelineno-19-46"></a><span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">always()</span>
<a id="__codelineno-19-47" name="__codelineno-19-47" href="#__codelineno-19-47"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-19-48" name="__codelineno-19-48" href="#__codelineno-19-48"></a><span class="w">        </span><span class="no"># Clean up PR-specific resources</span>
<a id="__codelineno-19-49" name="__codelineno-19-49" href="#__codelineno-19-49"></a><span class="w">        </span><span class="no">kubectl delete namespace dev-pr-${{ github.event.number }} --ignore-not-found=true</span>
</code></pre></div>
<blockquote>
<p>📁 <strong>Exercise Files</strong>: The complete GitHub Actions workflow is available at <a href="../../exercises/crossplane-advanced-patterns-01/.github/workflows/crossplane-pr-testing.yml"><code>exercises/crossplane-advanced-patterns-01/.github/workflows/crossplane-pr-testing.yml</code></a></p>
</blockquote>
<h3 id="52-environment-promotion-pipeline">5.2 Environment Promotion Pipeline<a class="headerlink" href="#52-environment-promotion-pipeline" title="Permanent link">&para;</a></h3>
<p>Following our <strong>controlled promotion</strong> pattern:</p>
<h4 id="stage-1-development-automatic">Stage 1: Development (Automatic)<a class="headerlink" href="#stage-1-development-automatic" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># After PR merge, ArgoCD automatically deploys to dev</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="c1"># No manual intervention needed</span>
</code></pre></div>
<h4 id="stage-2-staging-promotion-manual">Stage 2: Staging Promotion (Manual)<a class="headerlink" href="#stage-2-staging-promotion-manual" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># Platform team promotes to staging with environment-specific configs</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>git<span class="w"> </span>checkout<span class="w"> </span>main<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>git<span class="w"> </span>pull
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="c1"># Copy and modify for staging requirements</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>cp<span class="w"> </span>environments/dev/infrastructure/alice-dev.yaml<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="w">   </span>environments/staging/infrastructure/alice-staging.yaml
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="c1"># Update for staging-specific configuration</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/name: alice-dev/name: alice-staging/&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="w">    </span>environments/staging/infrastructure/alice-staging.yaml
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/namespace: dev/namespace: staging/&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="w">    </span>environments/staging/infrastructure/alice-staging.yaml<span class="w">  </span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/environment: dev/environment: staging/&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="w">    </span>environments/staging/infrastructure/alice-staging.yaml
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/purpose: development/purpose: staging/&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="w">    </span>environments/staging/infrastructure/alice-staging.yaml
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="c1"># Add staging-specific enhancements</span>
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>cat<span class="w"> </span>&gt;&gt;<span class="w"> </span>environments/staging/infrastructure/alice-staging.yaml<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="s">    # Staging-specific parameters</span>
<a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a><span class="s">    backup: true</span>
<a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a><span class="s">    monitoring: enabled</span>
<a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a><span class="s">    alerting: true</span>
<a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a><span class="s">EOF</span>
<a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a>
<a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a>git<span class="w"> </span>add<span class="w"> </span>environments/staging/infrastructure/alice-staging.yaml
<a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;feat: promote Alice&#39;s environment to staging</span>
<a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a>
<a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a><span class="s2">- Enable backup for data protection</span>
<a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a><span class="s2">- Add monitoring and alerting</span>
<a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a><span class="s2">- Staging-specific configuration applied&quot;</span>
<a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a>
<a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a><span class="c1"># Push to feature branch and create PR for staging promotion (requires review)</span>
<a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a>git<span class="w"> </span>push<span class="w"> </span>-u<span class="w"> </span>origin<span class="w"> </span>promote/alice-staging
<a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a>gh<span class="w"> </span>pr<span class="w"> </span>create<span class="w"> </span>--title<span class="w"> </span><span class="s2">&quot;Promote: Alice&#39;s environment to staging&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a><span class="w">             </span>--body<span class="w"> </span><span class="s2">&quot;Promoting validated dev environment to staging with enhanced configuration&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-21-37" name="__codelineno-21-37" href="#__codelineno-21-37"></a><span class="w">             </span>--reviewer<span class="w"> </span>platform-team
<a id="__codelineno-21-38" name="__codelineno-21-38" href="#__codelineno-21-38"></a>gh<span class="w"> </span>pr<span class="w"> </span>merge<span class="w"> </span>--auto<span class="w"> </span>--squash<span class="w"> </span>--delete-branch
</code></pre></div>
<h4 id="stage-3-production-promotion-strict-control">Stage 3: Production Promotion (Strict Control)<a class="headerlink" href="#stage-3-production-promotion-strict-control" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1"># Production requires additional approval and safeguards  </span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>cp<span class="w"> </span>environments/staging/infrastructure/alice-staging.yaml<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">   </span>environments/production/infrastructure/alice-prod.yaml
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="c1"># Production-specific configuration</span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/alice-staging/alice-prod/g&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="w">    </span>environments/production/infrastructure/alice-prod.yaml
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/namespace: staging/namespace: production/&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="w">    </span>environments/production/infrastructure/alice-prod.yaml
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="c1"># Add production-specific requirements</span>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a>cat<span class="w"> </span>&gt;&gt;<span class="w"> </span>environments/production/infrastructure/alice-prod.yaml<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="s">    # Production-specific parameters</span>
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="s">    highAvailability: true</span>
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="s">    backup: true</span>
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="s">    backupRetention: 30</span>
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a><span class="s">    monitoring: enabled</span>
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a><span class="s">    alerting: critical</span>
<a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a><span class="s">    disasterRecovery: enabled</span>
<a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a><span class="s">EOF</span>
<a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a>
<a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a>git<span class="w"> </span>add<span class="w"> </span>environments/production/infrastructure/alice-prod.yaml
<a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;feat: promote Alice&#39;s environment to production</span>
<a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a>
<a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a><span class="s2">- Enable high availability and disaster recovery</span>
<a id="__codelineno-22-26" name="__codelineno-22-26" href="#__codelineno-22-26"></a><span class="s2">- Set 30-day backup retention</span>
<a id="__codelineno-22-27" name="__codelineno-22-27" href="#__codelineno-22-27"></a><span class="s2">- Configure critical alerting</span>
<a id="__codelineno-22-28" name="__codelineno-22-28" href="#__codelineno-22-28"></a><span class="s2">- Production-ready configuration&quot;</span>
<a id="__codelineno-22-29" name="__codelineno-22-29" href="#__codelineno-22-29"></a>
<a id="__codelineno-22-30" name="__codelineno-22-30" href="#__codelineno-22-30"></a><span class="c1"># This triggers GitHub Environment protection rules</span>
<a id="__codelineno-22-31" name="__codelineno-22-31" href="#__codelineno-22-31"></a>gh<span class="w"> </span>pr<span class="w"> </span>create<span class="w"> </span>--title<span class="w"> </span><span class="s2">&quot;🔒 PRODUCTION: Alice&#39;s environment&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-22-32" name="__codelineno-22-32" href="#__codelineno-22-32"></a><span class="w">             </span>--body<span class="w"> </span><span class="s2">&quot;Production deployment - requires platform team approval&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-22-33" name="__codelineno-22-33" href="#__codelineno-22-33"></a><span class="w">             </span>--label<span class="w"> </span><span class="s2">&quot;production,requires-approval&quot;</span>
</code></pre></div>
<h3 id="53-argocd-applications-for-environment-based-workflow">5.3 ArgoCD Applications for Environment-Based Workflow<a class="headerlink" href="#53-argocd-applications-for-environment-based-workflow" title="Permanent link">&para;</a></h3>
<p>Create <strong>ArgoCD ApplicationSet</strong> to manage environments following our GitOps patterns:</p>
<div class="language-yaml highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1"># applications/platform/environment-applicationset.yaml</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ApplicationSet</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crossplane-environments</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">argocd</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crossplane-tutorial</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">    </span><span class="nt">component</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">environment-management</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">  </span><span class="nt">generators</span><span class="p">:</span>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">matrix</span><span class="p">:</span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="w">      </span><span class="nt">generators</span><span class="p">:</span>
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">git</span><span class="p">:</span>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="w">          </span><span class="nt">repoURL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/your-username/your-tutorial-repo.git</span>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="w">          </span><span class="nt">revision</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HEAD</span>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="w">          </span><span class="nt">directories</span><span class="p">:</span>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">environments/*</span>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">list</span><span class="p">:</span>
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="w">          </span><span class="nt">elements</span><span class="p">:</span>
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://kubernetes.default.svc</span>
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="w">            </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in-cluster</span>
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a><span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;crossplane-{{path.basename}}&#39;</span>
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a><span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crossplane-tutorial</span>
<a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a><span class="w">        </span><span class="nt">environment</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{path.basename}}&#39;</span>
<a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a><span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a><span class="w">      </span><span class="nt">project</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a><span class="w">      </span><span class="nt">source</span><span class="p">:</span>
<a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a><span class="w">        </span><span class="nt">repoURL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/your-username/your-tutorial-repo.git</span>
<a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a><span class="w">        </span><span class="nt">targetRevision</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HEAD</span>
<a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a><span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{path}}/infrastructure&#39;</span>
<a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a><span class="w">      </span><span class="nt">destination</span><span class="p">:</span>
<a id="__codelineno-23-36" name="__codelineno-23-36" href="#__codelineno-23-36"></a><span class="w">        </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{cluster}}&#39;</span>
<a id="__codelineno-23-37" name="__codelineno-23-37" href="#__codelineno-23-37"></a><span class="w">        </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{path.basename}}&#39;</span><span class="w">  </span><span class="c1"># Deploy to environment-specific namespace</span>
<a id="__codelineno-23-38" name="__codelineno-23-38" href="#__codelineno-23-38"></a><span class="w">      </span><span class="nt">syncPolicy</span><span class="p">:</span>
<a id="__codelineno-23-39" name="__codelineno-23-39" href="#__codelineno-23-39"></a><span class="w">        </span><span class="nt">automated</span><span class="p">:</span>
<a id="__codelineno-23-40" name="__codelineno-23-40" href="#__codelineno-23-40"></a><span class="w">          </span><span class="nt">prune</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-23-41" name="__codelineno-23-41" href="#__codelineno-23-41"></a><span class="w">          </span><span class="nt">selfHeal</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-23-42" name="__codelineno-23-42" href="#__codelineno-23-42"></a><span class="w">        </span><span class="nt">syncOptions</span><span class="p">:</span>
<a id="__codelineno-23-43" name="__codelineno-23-43" href="#__codelineno-23-43"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CreateNamespace=true</span>
<a id="__codelineno-23-44" name="__codelineno-23-44" href="#__codelineno-23-44"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ApplyOutOfSyncOnly=true</span>
<a id="__codelineno-23-45" name="__codelineno-23-45" href="#__codelineno-23-45"></a><span class="w">        </span><span class="c1"># Environment-specific sync policies</span>
<a id="__codelineno-23-46" name="__codelineno-23-46" href="#__codelineno-23-46"></a><span class="w">        </span><span class="nt">retry</span><span class="p">:</span>
<a id="__codelineno-23-47" name="__codelineno-23-47" href="#__codelineno-23-47"></a><span class="w">          </span><span class="nt">limit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<a id="__codelineno-23-48" name="__codelineno-23-48" href="#__codelineno-23-48"></a><span class="w">          </span><span class="nt">backoff</span><span class="p">:</span>
<a id="__codelineno-23-49" name="__codelineno-23-49" href="#__codelineno-23-49"></a><span class="w">            </span><span class="nt">duration</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5s</span>
<a id="__codelineno-23-50" name="__codelineno-23-50" href="#__codelineno-23-50"></a><span class="w">            </span><span class="nt">maxDuration</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3m0s</span>
<a id="__codelineno-23-51" name="__codelineno-23-51" href="#__codelineno-23-51"></a><span class="w">      </span><span class="c1"># Crossplane-specific health checks</span>
<a id="__codelineno-23-52" name="__codelineno-23-52" href="#__codelineno-23-52"></a><span class="w">      </span><span class="nt">ignoreDifferences</span><span class="p">:</span>
<a id="__codelineno-23-53" name="__codelineno-23-53" href="#__codelineno-23-53"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform.tutorial.com</span>
<a id="__codelineno-23-54" name="__codelineno-23-54" href="#__codelineno-23-54"></a><span class="w">        </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">XDevEnvironment</span>
<a id="__codelineno-23-55" name="__codelineno-23-55" href="#__codelineno-23-55"></a><span class="w">        </span><span class="nt">jsonPointers</span><span class="p">:</span>
<a id="__codelineno-23-56" name="__codelineno-23-56" href="#__codelineno-23-56"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/metadata/generation</span>
<a id="__codelineno-23-57" name="__codelineno-23-57" href="#__codelineno-23-57"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/status</span>
</code></pre></div>
<blockquote>
<p>📁 <strong>Exercise Files</strong>: The complete ArgoCD ApplicationSet configuration is available at <a href="../../exercises/crossplane-advanced-patterns-01/applications/platform/environment-applicationset.yaml"><code>exercises/crossplane-advanced-patterns-01/applications/platform/environment-applicationset.yaml</code></a></p>
</blockquote>
<p><strong>Benefits of this ApplicationSet approach:</strong>
- <strong>Automatic discovery</strong> of new environments (dev, staging, production)
- <strong>Environment-specific namespaces</strong> for proper isolation
- <strong>Consistent sync policies</strong> across all environments
- <strong>Crossplane-aware</strong> health checking and status monitoring</p>
<h3 id="54-deploy-gitops-infrastructure">5.4 Deploy GitOps Infrastructure<a class="headerlink" href="#54-deploy-gitops-infrastructure" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c1"># Deploy platform components (XRDs, Compositions)</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>applications/platform/platform-apis.yaml
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="c1"># Deploy environment management ApplicationSet</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>applications/platform/environment-applicationset.yaml
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="c1"># Watch environments being created</span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>kubectl<span class="w"> </span>get<span class="w"> </span>applications<span class="w"> </span>-n<span class="w"> </span>argocd<span class="w"> </span>-l<span class="w"> </span><span class="nv">app</span><span class="o">=</span>crossplane-tutorial
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="c1"># Monitor Crossplane resources across environments</span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>watch<span class="w"> </span><span class="s2">&quot;kubectl get xdevenvironments --all-namespaces&quot;</span>
</code></pre></div>
<h3 id="55-gitops-monitoring-troubleshooting">5.5 GitOps Monitoring &amp; Troubleshooting<a class="headerlink" href="#55-gitops-monitoring-troubleshooting" title="Permanent link">&para;</a></h3>
<h4 id="monitor-gitops-crossplane-health">Monitor GitOps + Crossplane Health<a class="headerlink" href="#monitor-gitops-crossplane-health" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1"># 1. Check ArgoCD Application health across environments</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>kubectl<span class="w"> </span>get<span class="w"> </span>applications<span class="w"> </span>-n<span class="w"> </span>argocd<span class="w"> </span>-l<span class="w"> </span><span class="nv">app</span><span class="o">=</span>crossplane-tutorial<span class="w"> </span>-o<span class="w"> </span>wide
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="c1"># 2. Monitor Crossplane resources across environments  </span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>kubectl<span class="w"> </span>get<span class="w"> </span>xdevenvironments<span class="w"> </span>--all-namespaces<span class="w"> </span>-o<span class="w"> </span>wide
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="c1"># 3. Check for sync issues</span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>argocd<span class="w"> </span>app<span class="w"> </span>list<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>crossplane
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="c1"># 4. Monitor underlying Azure resources</span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>kubectl<span class="w"> </span>get<span class="w"> </span>managed<span class="w"> </span>--all-namespaces<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;alice-dev|ResourceGroup|VirtualNetwork&quot;</span>
</code></pre></div>
<h4 id="troubleshooting-common-gitops-crossplane-issues">Troubleshooting Common GitOps + Crossplane Issues<a class="headerlink" href="#troubleshooting-common-gitops-crossplane-issues" title="Permanent link">&para;</a></h4>
<p><strong>Issue 1: ArgoCD Out of Sync</strong>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c1"># Check specific application sync status</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>argocd<span class="w"> </span>app<span class="w"> </span>get<span class="w"> </span>crossplane-dev<span class="w"> </span>--output<span class="w"> </span>yaml
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="c1"># Force sync if needed</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>argocd<span class="w"> </span>app<span class="w"> </span>sync<span class="w"> </span>crossplane-dev<span class="w"> </span>--prune
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="c1"># Check for resource conflicts</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>kubectl<span class="w"> </span>get<span class="w"> </span>events<span class="w"> </span>-n<span class="w"> </span>dev<span class="w"> </span>--sort-by<span class="o">=</span><span class="s1">&#39;.lastTimestamp&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>error
</code></pre></div></p>
<p><strong>Issue 2: Crossplane Resource Stuck</strong>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1"># Check Composite Resource conditions</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>kubectl<span class="w"> </span>describe<span class="w"> </span>xdevenvironment<span class="w"> </span>alice-dev<span class="w"> </span>-n<span class="w"> </span>dev
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="c1"># Check underlying Managed Resources</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>kubectl<span class="w"> </span>get<span class="w"> </span>managed<span class="w"> </span>-l<span class="w"> </span>crossplane.io/composite<span class="o">=</span>alice-dev<span class="w"> </span>-n<span class="w"> </span>dev
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="c1"># Force reconciliation</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>kubectl<span class="w"> </span>annotate<span class="w"> </span>xdevenvironment<span class="w"> </span>alice-dev<span class="w"> </span>-n<span class="w"> </span>dev<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">  </span>crossplane.io/reconcile<span class="o">=</span><span class="k">$(</span>date<span class="w"> </span>+%Y%m%d%H%M%S<span class="k">)</span><span class="w"> </span>--overwrite
</code></pre></div></p>
<p><strong>Issue 3: Environment Promotion Failure</strong>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1"># Compare environment configurations</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>diff<span class="w"> </span>environments/dev/infrastructure/alice-dev.yaml<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">     </span>environments/staging/infrastructure/alice-staging.yaml
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="c1"># Validate staging-specific resources</span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>kubectl<span class="w"> </span>diff<span class="w"> </span>-f<span class="w"> </span>environments/staging/infrastructure/<span class="w"> </span>--dry-run<span class="o">=</span>server
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="c1"># Check promotion pipeline status</span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>gh<span class="w"> </span>pr<span class="w"> </span>list<span class="w"> </span>--label<span class="w"> </span><span class="s2">&quot;promotion&quot;</span><span class="w"> </span>--state<span class="w"> </span><span class="s2">&quot;open&quot;</span>
</code></pre></div></p>
<h2 id="step-6-gitops-crossplane-integration-benefits">Step 6: GitOps + Crossplane Integration Benefits<a class="headerlink" href="#step-6-gitops-crossplane-integration-benefits" title="Permanent link">&para;</a></h2>
<h3 id="61-end-to-end-workflow-visualization">6.1 End-to-End Workflow Visualization<a class="headerlink" href="#61-end-to-end-workflow-visualization" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>graph TB
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>    subgraph &quot;GitHub Repository&quot;
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>        A[platform-core/] --&gt; A1[XRDs]
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>        A --&gt; A2[Compositions]
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>        B[environments/dev/] --&gt; B1[alice-dev.yaml]
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>        C[environments/staging/] --&gt; C1[alice-staging.yaml]  
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>        D[environments/production/] --&gt; D1[alice-prod.yaml]
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>    end
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>    subgraph &quot;ArgoCD (GitOps Controller)&quot;
<a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a>        E[ApplicationSet&lt;br/&gt;crossplane-environments]
<a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a>        F[Application&lt;br/&gt;crossplane-dev]
<a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a>        G[Application&lt;br/&gt;crossplane-staging] 
<a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a>        H[Application&lt;br/&gt;crossplane-production]
<a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a>    end
<a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a>
<a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a>    subgraph &quot;Kubernetes + Crossplane&quot;
<a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a>        I[dev namespace&lt;br/&gt;XDevEnvironment]
<a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a>        J[staging namespace&lt;br/&gt;XDevEnvironment]
<a id="__codelineno-29-20" name="__codelineno-29-20" href="#__codelineno-29-20"></a>        K[production namespace&lt;br/&gt;XDevEnvironment]
<a id="__codelineno-29-21" name="__codelineno-29-21" href="#__codelineno-29-21"></a>    end
<a id="__codelineno-29-22" name="__codelineno-29-22" href="#__codelineno-29-22"></a>
<a id="__codelineno-29-23" name="__codelineno-29-23" href="#__codelineno-29-23"></a>    subgraph &quot;Azure Cloud&quot;
<a id="__codelineno-29-24" name="__codelineno-29-24" href="#__codelineno-29-24"></a>        L[alice-dev-rg&lt;br/&gt;alice-dev-vnet]
<a id="__codelineno-29-25" name="__codelineno-29-25" href="#__codelineno-29-25"></a>        M[alice-staging-rg&lt;br/&gt;alice-staging-vnet]
<a id="__codelineno-29-26" name="__codelineno-29-26" href="#__codelineno-29-26"></a>        N[alice-prod-rg&lt;br/&gt;alice-prod-vnet]
<a id="__codelineno-29-27" name="__codelineno-29-27" href="#__codelineno-29-27"></a>    end
<a id="__codelineno-29-28" name="__codelineno-29-28" href="#__codelineno-29-28"></a>
<a id="__codelineno-29-29" name="__codelineno-29-29" href="#__codelineno-29-29"></a>    B1 --&gt; F --&gt; I --&gt; L
<a id="__codelineno-29-30" name="__codelineno-29-30" href="#__codelineno-29-30"></a>    C1 --&gt; G --&gt; J --&gt; M  
<a id="__codelineno-29-31" name="__codelineno-29-31" href="#__codelineno-29-31"></a>    D1 --&gt; H --&gt; K --&gt; N
<a id="__codelineno-29-32" name="__codelineno-29-32" href="#__codelineno-29-32"></a>    E --&gt; F
<a id="__codelineno-29-33" name="__codelineno-29-33" href="#__codelineno-29-33"></a>    E --&gt; G
<a id="__codelineno-29-34" name="__codelineno-29-34" href="#__codelineno-29-34"></a>    E --&gt; H
<a id="__codelineno-29-35" name="__codelineno-29-35" href="#__codelineno-29-35"></a>
<a id="__codelineno-29-36" name="__codelineno-29-36" href="#__codelineno-29-36"></a>    style A fill:#f9f,stroke:#333,stroke-width:2px
<a id="__codelineno-29-37" name="__codelineno-29-37" href="#__codelineno-29-37"></a>    style I fill:#bbf,stroke:#333,stroke-width:2px
<a id="__codelineno-29-38" name="__codelineno-29-38" href="#__codelineno-29-38"></a>    style L fill:#bfb,stroke:#333,stroke-width:2px
</code></pre></div>
<h3 id="62-rock-solid-workflow-benefits">6.2 Rock-Solid Workflow Benefits<a class="headerlink" href="#62-rock-solid-workflow-benefits" title="Permanent link">&para;</a></h3>
<p>✅ <strong>Developer Experience</strong>
- <strong>Familiar GitHub Flow</strong> - no new workflows to learn
- <strong>Environment parity</strong> - same code promoted through environments
- <strong>Fast feedback</strong> - PR environments for infrastructure testing
- <strong>Self-service</strong> - developers create environments via Git</p>
<p>✅ <strong>Platform Engineering</strong><br />
- <strong>Infrastructure as Code</strong> - everything in Git with full audit trail
- <strong>Environment-specific tuning</strong> - dev vs staging vs production configs
- <strong>Reusable components</strong> - XRDs and Compositions shared across environments
- <strong>Automated promotion</strong> - controlled pipeline with approval gates</p>
<p>✅ <strong>Operational Excellence</strong>
- <strong>GitOps compliance</strong> - declarative, auditable, recoverable
- <strong>Multi-environment safety</strong> - isolated namespaces and configs<br />
- <strong>Automatic rollback</strong> - failed deployments revert via ArgoCD
- <strong>Monitoring integration</strong> - Crossplane health visible in ArgoCD</p>
<p>✅ <strong>Enterprise Readiness</strong>
- <strong>RBAC integration</strong> - namespace-based access control
- <strong>Compliance tracking</strong> - Git provides complete audit trail
- <strong>Disaster recovery</strong> - infrastructure recreated from Git
- <strong>Cost management</strong> - environment-specific resource sizing</p>
<p><strong>Key v2 Relationships:</strong>
- <strong>Developers create XRs directly</strong> in namespaces (no Claims layer)
- <strong>Managed Resources live in same namespace</strong> as the XR for isolation
- <strong>Function pipeline processes</strong> the XR and creates managed resources
- <strong>Composition and XRD</strong> remain cluster-scoped for platform reuse</p>
<h3 id="62-check-environment-status">6.2 Check Environment Status<a class="headerlink" href="#62-check-environment-status" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1"># Get detailed environment status</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>kubectl<span class="w"> </span>get<span class="w"> </span>devenvironment<span class="w"> </span>alice-dev<span class="w"> </span>-n<span class="w"> </span>crossplane-system<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-A<span class="w"> </span><span class="m">20</span><span class="w"> </span>status
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="c1"># Check resource readiness</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>kubectl<span class="w"> </span>describe<span class="w"> </span>devenvironment<span class="w"> </span>alice-dev<span class="w"> </span>-n<span class="w"> </span>crossplane-system
</code></pre></div>
<p>Look for:
- <code>resourceGroupId</code>: Azure resource group ID
- <code>virtualNetworkId</code>: Azure VNet ID<br />
- <code>ready: true</code>: Environment is fully provisioned</p>
<h2 id="step-7-add-another-developer">Step 7: Add Another Developer<a class="headerlink" href="#step-7-add-another-developer" title="Permanent link">&para;</a></h2>
<p>Development teams can easily add more environments using the same pattern:</p>
<div class="language-yaml highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1"># applications/environments/bob-dev.yaml</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform.tutorial.com/v1alpha1</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">XDevEnvironment</span>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bob-dev</span>
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crossplane-tutorial</span>
<a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="w">    </span><span class="nt">owner</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bob</span>
<a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="w">    </span><span class="nt">purpose</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">development</span>
<a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a><span class="w">  </span><span class="nt">parameters</span><span class="p">:</span>
<a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bob-dev</span>
<a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a><span class="w">    </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">westus2</span>
<a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a><span class="w">    </span><span class="nt">resourceGroupLocation</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;West</span><span class="nv"> </span><span class="s">US</span><span class="nv"> </span><span class="s">2&quot;</span>
<a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a><span class="w">    </span><span class="nt">tags</span><span class="p">:</span>
<a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a><span class="w">      </span><span class="nt">owner</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bob</span>
<a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a><span class="w">      </span><span class="nt">team</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">backend</span>
<a id="__codelineno-31-19" name="__codelineno-31-19" href="#__codelineno-31-19"></a><span class="w">      </span><span class="nt">cost-center</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5678&quot;</span>
<a id="__codelineno-31-20" name="__codelineno-31-20" href="#__codelineno-31-20"></a><span class="w">      </span><span class="nt">purpose</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">development</span>
<a id="__codelineno-31-21" name="__codelineno-31-21" href="#__codelineno-31-21"></a><span class="w">  </span><span class="nt">crossplane</span><span class="p">:</span>
<a id="__codelineno-31-22" name="__codelineno-31-22" href="#__codelineno-31-22"></a><span class="w">    </span><span class="nt">compositionRef</span><span class="p">:</span>
<a id="__codelineno-31-23" name="__codelineno-31-23" href="#__codelineno-31-23"></a><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev-environment-azure</span>
</code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c1"># Deploy Bob&#39;s environment  </span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>git<span class="w"> </span>add<span class="w"> </span>applications/environments/bob-dev.yaml
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;feat: create Bob&#39;s development environment in West US 2&quot;</span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>git<span class="w"> </span>push
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="c1"># ArgoCD will automatically sync and create the environment</span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>kubectl<span class="w"> </span>get<span class="w"> </span>xdevenvironments<span class="w"> </span>-n<span class="w"> </span>default<span class="w"> </span>-w
</code></pre></div>
<h2 id="learning-outcomes">Learning Outcomes<a class="headerlink" href="#learning-outcomes" title="Permanent link">&para;</a></h2>
<p>After completing this module, you should understand:</p>
<ul>
<li>✅ <strong>XRD Design</strong>: How to create developer-friendly APIs</li>
<li>✅ <strong>Composition Patterns</strong>: Bundling resources with relationships</li>
<li>✅ <strong>Patching Strategies</strong>: Moving data between resources</li>
<li>✅ <strong>GitOps Platform Deployment</strong>: Managing platform components</li>
<li>✅ <strong>Resource Abstraction</strong>: Hiding complexity while maintaining capability</li>
</ul>
<h2 id="advanced-concepts-introduced">Advanced Concepts Introduced<a class="headerlink" href="#advanced-concepts-introduced" title="Permanent link">&para;</a></h2>
<h3 id="api-design-principles">API Design Principles<a class="headerlink" href="#api-design-principles" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Simple parameters</strong>: Complex Azure configuration hidden</li>
<li><strong>Validation</strong>: Enum values and pattern matching prevent errors</li>
<li><strong>Defaults</strong>: Sensible defaults reduce cognitive load</li>
<li><strong>Status reporting</strong>: Clear information about environment state</li>
</ul>
<h3 id="composition-techniques">Composition Techniques<a class="headerlink" href="#composition-techniques" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Resource dependencies</strong>: VNet references Resource Group</li>
<li><strong>Field transformations</strong>: String formatting for naming</li>
<li><strong>Tag merging</strong>: Combine platform and user tags</li>
<li><strong>Status propagation</strong>: Report Azure IDs back to developers</li>
</ul>
<h2 id="troubleshooting-common-issues">Troubleshooting Common Issues<a class="headerlink" href="#troubleshooting-common-issues" title="Permanent link">&para;</a></h2>
<h3 id="xrd-not-available">XRD Not Available<a class="headerlink" href="#xrd-not-available" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c1"># Check XRD status</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>kubectl<span class="w"> </span>get<span class="w"> </span>xrd<span class="w"> </span>xdevenvironments.platform.tutorial.com
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>kubectl<span class="w"> </span>describe<span class="w"> </span>xrd<span class="w"> </span>xdevenvironments.platform.tutorial.com
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="c1"># Verify ArgoCD sync</span>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>argocd<span class="w"> </span>app<span class="w"> </span>get<span class="w"> </span>platform-xrds
</code></pre></div>
<h3 id="composition-not-working">Composition Not Working<a class="headerlink" href="#composition-not-working" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c1"># Check composition status</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>kubectl<span class="w"> </span>describe<span class="w"> </span>composition<span class="w"> </span>dev-environment-azure
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="c1"># Look for events on the XR</span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>kubectl<span class="w"> </span>describe<span class="w"> </span>xdevenvironment<span class="w"> </span>&lt;name&gt;<span class="w"> </span>-n<span class="w"> </span>crossplane-system
</code></pre></div>
<h3 id="resources-not-creating">Resources Not Creating<a class="headerlink" href="#resources-not-creating" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c1"># Check the composite resource</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>kubectl<span class="w"> </span>get<span class="w"> </span>xdevenvironments<span class="w"> </span>-n<span class="w"> </span>crossplane-system
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>kubectl<span class="w"> </span>describe<span class="w"> </span>xdevenvironment<span class="w"> </span>&lt;name&gt;<span class="w"> </span>-n<span class="w"> </span>crossplane-system
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="c1"># Check managed resources</span>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>kubectl<span class="w"> </span>get<span class="w"> </span>managed<span class="w"> </span>-n<span class="w"> </span>crossplane-system<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>&lt;name&gt;
</code></pre></div>
<h2 id="platform-documentation">Platform Documentation<a class="headerlink" href="#platform-documentation" title="Permanent link">&para;</a></h2>
<h3 id="developer-guide">Developer Guide<a class="headerlink" href="#developer-guide" title="Permanent link">&para;</a></h3>
<p>Create documentation for your platform users:</p>
<div class="language-markdown highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="gh"># Development Environment Platform</span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="gu">## Quick Start</span>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>Create a new development environment:
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>```yaml
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>apiVersion: platform.tutorial.com/v1alpha1
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>kind: DevEnvironment
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>metadata:
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a>  name: my-dev-env
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>spec:
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>  parameters:
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>    name: my-dev-env
<a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a>    region: eastus
<a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a>    tags:
<a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a>      owner: your-name
<a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a>      team: your-team
</code></pre></div>
<h2 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">&para;</a></h2>
<ul>
<li><code>name</code>: Environment identifier (required)</li>
<li><code>region</code>: Azure region (default: eastus)</li>
<li><code>tags</code>: Additional resource tags (optional)</li>
</ul>
<h2 id="what-you-get">What You Get<a class="headerlink" href="#what-you-get" title="Permanent link">&para;</a></h2>
<ul>
<li>Azure Resource Group</li>
<li>Virtual Network (10.0.0.0/16)</li>
<li>Proper tagging and labeling</li>
<li>Automatic cleanup on deletion
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>## Next Steps
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>Congratulations! You&#39;ve built your first platform API. Developers can now request complete environments with simple YAML files.
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>In the next module, we&#39;ll add networking components (subnets, security groups) to make the environments more complete and production-ready.
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>**➡️ [Module 2: Networking Composition](02-networking-composition.md)**
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a>
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>---
<a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a>
<a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a>## Quick Reference
<a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a>
<a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a>### Platform Commands
<a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a>
<a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a>```bash
<a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a># List all platform APIs
<a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a>kubectl api-resources | grep platform.tutorial.com
<a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a>
<a id="__codelineno-37-19" name="__codelineno-37-19" href="#__codelineno-37-19"></a># Get all environments (now in default namespace)
<a id="__codelineno-37-20" name="__codelineno-37-20" href="#__codelineno-37-20"></a>kubectl get xdevenvironments -n default
<a id="__codelineno-37-21" name="__codelineno-37-21" href="#__codelineno-37-21"></a>
<a id="__codelineno-37-22" name="__codelineno-37-22" href="#__codelineno-37-22"></a># Check environment status
<a id="__codelineno-37-23" name="__codelineno-37-23" href="#__codelineno-37-23"></a>kubectl describe xdevenvironment &lt;name&gt; -n default
<a id="__codelineno-37-24" name="__codelineno-37-24" href="#__codelineno-37-24"></a>
<a id="__codelineno-37-25" name="__codelineno-37-25" href="#__codelineno-37-25"></a># List all managed resources for an environment (in same namespace)
<a id="__codelineno-37-26" name="__codelineno-37-26" href="#__codelineno-37-26"></a>kubectl get managed -l crossplane.io/composite=&lt;name&gt; -n default
</code></pre></div></li>
</ul>
<h3 id="file-structure-created">File Structure Created<a class="headerlink" href="#file-structure-created" title="Permanent link">&para;</a></h3>
<p><strong>Rock-solid GitOps + Crossplane integration:</strong></p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a># Platform components (shared, reusable, environment-agnostic)
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>platform-core/
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>├── xrds/
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>│   └── dev-environment-xrd.yaml        # Platform API definitions
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>├── compositions/
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>│   └── dev-environment-composition.yaml # Platform implementation logic
<a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>└── functions/
<a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a>    └── function-installations.yaml      # Composition functions
<a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a>
<a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a># Environment-specific infrastructure (follows promotion pipeline)
<a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a>environments/
<a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a>├── dev/
<a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a>│   └── infrastructure/
<a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a>│       └── alice-dev.yaml              # Development environment instances
<a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a>├── staging/
<a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a>│   └── infrastructure/
<a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a>│       └── alice-staging.yaml          # Staging environment instances
<a id="__codelineno-38-18" name="__codelineno-38-18" href="#__codelineno-38-18"></a>└── production/
<a id="__codelineno-38-19" name="__codelineno-38-19" href="#__codelineno-38-19"></a>    └── infrastructure/
<a id="__codelineno-38-20" name="__codelineno-38-20" href="#__codelineno-38-20"></a>        └── alice-prod.yaml             # Production environment instances
<a id="__codelineno-38-21" name="__codelineno-38-21" href="#__codelineno-38-21"></a>
<a id="__codelineno-38-22" name="__codelineno-38-22" href="#__codelineno-38-22"></a># GitOps management layer (ArgoCD Applications)  
<a id="__codelineno-38-23" name="__codelineno-38-23" href="#__codelineno-38-23"></a>applications/
<a id="__codelineno-38-24" name="__codelineno-38-24" href="#__codelineno-38-24"></a>├── platform/
<a id="__codelineno-38-25" name="__codelineno-38-25" href="#__codelineno-38-25"></a>│   ├── platform-apis.yaml             # Manages platform-core components
<a id="__codelineno-38-26" name="__codelineno-38-26" href="#__codelineno-38-26"></a>│   └── environment-applicationset.yaml # Manages all environments
<a id="__codelineno-38-27" name="__codelineno-38-27" href="#__codelineno-38-27"></a>└── workflows/
<a id="__codelineno-38-28" name="__codelineno-38-28" href="#__codelineno-38-28"></a>    ├── pr-testing.yaml                 # PR environment automation
<a id="__codelineno-38-29" name="__codelineno-38-29" href="#__codelineno-38-29"></a>    └── promotion-pipeline.yaml         # Environment promotion workflow
<a id="__codelineno-38-30" name="__codelineno-38-30" href="#__codelineno-38-30"></a>
<a id="__codelineno-38-31" name="__codelineno-38-31" href="#__codelineno-38-31"></a># GitHub Workflows (automation)
<a id="__codelineno-38-32" name="__codelineno-38-32" href="#__codelineno-38-32"></a>.github/workflows/
<a id="__codelineno-38-33" name="__codelineno-38-33" href="#__codelineno-38-33"></a>├── crossplane-pr-testing.yml          # PR environment creation/testing
<a id="__codelineno-38-34" name="__codelineno-38-34" href="#__codelineno-38-34"></a>├── production-promotion.yml           # Production deployment gates
<a id="__codelineno-38-35" name="__codelineno-38-35" href="#__codelineno-38-35"></a>└── drift-detection.yml                # Environment drift monitoring
</code></pre></div>
<p><strong>GitOps Workflow Integration Benefits:</strong></p>
<p>✅ <strong>Environment Separation</strong>: Clear dev → staging → production promotion path
✅ <strong>Platform Reusability</strong>: XRDs and Compositions shared across all environments<br />
✅ <strong>GitOps Compliance</strong>: Full audit trail and declarative infrastructure
✅ <strong>Developer Self-Service</strong>: Teams create environments via familiar Git workflow
✅ <strong>Operational Safety</strong>: Approval gates, automated testing, rollback capabilities
✅ <strong>Monitoring Integration</strong>: Crossplane health visible in ArgoCD dashboard</p>
<p><strong>This structure enables:</strong>
- <strong>GitHub Flow compatibility</strong> with trunk-based development
- <strong>Controlled environment promotion</strong> with manual approval gates
- <strong>Automated PR testing</strong> with ephemeral infrastructure environments<br />
- <strong>Emergency hotfix procedures</strong> that bypass normal workflow when needed
- <strong>Complete audit trail</strong> via Git history for compliance and troubleshooting</p>
<p><strong>Perfect for teams that need enterprise-grade infrastructure management with startup-level agility!</strong> 🚀</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>